<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[å‡ è°· åšå®¢]]></title>
  <link href="http://kayorl.com/atom.xml" rel="self"/>
  <link href="http://kayorl.com/"/>
  <updated>2017-02-16T22:10:36+08:00</updated>
  <id>http://kayorl.com/</id>
  <author>
    <name><![CDATA[]]></name>
    
  </author>
  <generator uri="http://www.mweb.im/">MWeb</generator>
  
  <entry>
    <title type="html"><![CDATA[MySQL è¯­å¥]]></title>
    <link href="http://kayorl.com/14872445826285.html"/>
    <updated>2017-02-16T19:29:42+08:00</updated>
    <id>http://kayorl.com/14872445826285.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<h2 id="toc_0">å­˜å‚¨åˆ›å»ºæ—¶é—´å’Œæœ€åä¿®æ”¹æ—¶é—´</h2>

<pre><code class="language-sql">CREATE TABLE t1
(
    tb_created TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ts_modifiled TIMESTAMP DEFAULT CURRNET_TIMESTAMP
                            ON UPDATE CURRENT_TIMESTAMP,
    ...
):
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MySQL5.7 ä»ç›¸è§åˆ°ğŸ‘‹]]></title>
    <link href="http://kayorl.com/14872339187000.html"/>
    <updated>2017-02-16T16:31:58+08:00</updated>
    <id>http://kayorl.com/14872339187000.html</id>
    <content type="html"><![CDATA[
<p>æˆ‘çš„æ„ä¸­äººæ˜¯ä¸ªç›–ä¸–è‹±é›„<br/>
æœ‰ä¸€å¤©ä»–ä¼šè¸©ç€ä¸ƒè‰²äº‘å½©æ¥å¨¶æˆ‘<br/>
æˆ‘çŒœä¸­äº†å‰å¤´,<br/>
å¯æ˜¯æˆ‘çŒœä¸ç€è¿™ç»“å±€</p>

<span id="more"></span><!-- more -->

<ul>
<li>
<a href="#toc_0">å®‰è£…</a>
</li>
<li>
<a href="#toc_1">å»ºç«‹ä¸ MySQL æœåŠ¡å™¨çš„è¿æ¥</a>
</li>
<li>
<a href="#toc_2">å¯¼å…¥ .sql æ–‡ä»¶</a>
</li>
<li>
<a href="#toc_3">ä¿®æ”¹æ—¶åŒº</a>
</li>
<li>
<a href="#toc_4">å¤‡ä»½</a>
</li>
<li>
<a href="#toc_5">å¸è½½</a>
</li>
</ul>


<h2 id="toc_0">å®‰è£…</h2>

<p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-mysql-on-ubuntu-16-04">DOæ•™ç¨‹</a></p>

<pre><code># å®‰è£… 
$ sudo apt-get update
$ sudo apt-get install mysql-server

# ä¿®æ”¹æ•°æ®åº“çš„å®‰å…¨é…ç½®ï¼Œå¦‚ç¦ç”¨è¿œç¨‹ root ç”¨æˆ·
$ sudo mysql_secure_installation

## æµ‹è¯•æ•°æ®åº“çŠ¶æ€
$ systemctl status mysql.service
</code></pre>

<h2 id="toc_1">å»ºç«‹ä¸ MySQL æœåŠ¡å™¨çš„è¿æ¥</h2>

<p>ä¸ºè¿æ¥åˆ° MySQL æœåŠ¡å™¨,åœ¨å‘½ä»¤è¡Œä¸­è°ƒç”¨ mysql ç¨‹åº</p>

<pre><code>$ mysql -h host_name -p -u user_name -D database_name
</code></pre>

<ul>
<li><code>mysql</code> æ˜¯å¿…é¡»çš„, å…¶ä»–å¯é€‰</li>
<li>-h  host_nameã€€ã€€ã€€ä¸»æœºåœ°å€,é»˜è®¤ä¸ºæœ¬åœ°</li>
<li>-u  user_nameã€€ã€€ã€€MySQL ç”¨æˆ·å</li>
<li>-pã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€å›æ˜¾ Enter password: ï¼Œå¦‚æœç›¸åº”ç”¨æˆ·åæœ‰å¯†ç è€Œæ²¡åŠ æ­¤é¡¹ï¼Œä¼šæ˜¾ç¤º<code>æ‹’ç»è®¿é—®</code></li>
<li>-D  database_name é€‰æ‹©æ“ä½œ(é»˜è®¤)çš„æ•°æ®åº“<br/></li>
</ul>

<h2 id="toc_2">å¯¼å…¥ .sql æ–‡ä»¶</h2>

<p>å¯ä»¥å°†ç¼–å†™å¥½çš„æ•°æ®åº“è¯­å¥å†™å…¥åˆ°æ–‡ä»¶ååç¼€ä¸º <code>.sql</code> çš„æ–‡ä»¶ä¸­,å¹¶è®°ä½å…¶è·¯å¾„,æœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨å‘½ä»¤è¡Œä¸­è¿›å…¥åˆ°.sql æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•,ç„¶ååœ¨<code>å‘½ä»¤è¡Œ</code>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤(çœç•¥äº†ä¸»æœºå,ç”¨æˆ·,å¯†ç ç­‰å‚æ•°)</p>

<pre><code>$ mysql sampdb &lt; create_member.sql
</code></pre>

<p>å¦‚æœå·²ç»è¿›å…¥ mysql ç¨‹åºç•Œé¢,åˆ™æ‰§è¡Œ</p>

<pre><code>mysql&gt; source create_member.sql;
</code></pre>

<h2 id="toc_3">ä¿®æ”¹æ—¶åŒº</h2>

<pre><code># /etc/my.cnf

[mysqld]
...
default-time-zone = &#39;+8:00&#39;

$ systemctl restart mysql
</code></pre>

<h2 id="toc_4">å¤‡ä»½</h2>

<pre><code>$ mysqldump -u -p -D exampleDB &gt;my.sql
</code></pre>

<h2 id="toc_5">å¸è½½</h2>

<p>purge,ç¿»è¯‘è¿‡æ¥æ˜¯å‡€åŒ–çš„æ„æ€</p>

<pre><code>sudo apt-get remove --purge mysql*
sudo apt-get autoremove
sudo apt-get autoclean
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[è¯‘] Sequelize(6) sequelize-cliï¼Œå‡ºé—¨å¿…å¤‡è‰¯å“]]></title>
    <link href="http://kayorl.com/14872470138156.html"/>
    <updated>2017-02-16T20:10:13+08:00</updated>
    <id>http://kayorl.com/14872470138156.html</id>
    <content type="html"><![CDATA[
<p>è®©æ•°æ®åº“è½¬ç§»åˆ°é‚£äº›å¹´çš„çŠ¶æ€<br/>
é€šè¿‡<strong>è¿ç§»æ–‡ä»¶</strong>å­˜å‚¨æ•°æ®åº“ä¸åŒæ—¶æœŸçš„çŠ¶æ€ï¼Œæ¯ä¸ªè¿ç§»æ–‡ä»¶æè¿°äº†å¯¹æ•°æ®åº“çš„æ“ä½œ</p>

<span id="more"></span><!-- more -->

<p><strong>CLI</strong>:  <code>command-line interface</code> , å‘½ä»¤è¡Œç•Œé¢</p>

<h2 id="toc_0">å…¨å±€å®‰è£…</h2>

<pre><code>$ npm install -g sequelize-cli
</code></pre>

<h3 id="toc_1">ä½¿ç”¨</h3>

<pre><code>$ sequelize
</code></pre>

<p>è¿ç§»æ–‡ä»¶ä¸€èˆ¬é•¿è¿™æ ·</p>

<blockquote>
<p>queryInterface : ä¿®æ”¹æ•°æ®åº“</p>

<p>Sequelize : æä¾›å¤šç§ç±»å‹</p>
</blockquote>

<pre><code class="language-js">module.exports = {
  up: function(queryInterface, Sequelize) {
    // logic for transforming into the new state
  },
 
  down: function(queryInterface, Sequelize) {
    // logic for reverting the changes
  }
}
</code></pre>

<p>queryInterfaceæœ‰ä¸€ä¸‹å‡ ä¸ªå‡½æ•°ï¼ˆå¸¸ç”¨ï¼‰ï¼š</p>

<ul>
<li>createTable(tableName, attributes, options)</li>
<li>addIndex(tableName, attributes, options)</li>
<li>dropTable(tableName, options)</li>
</ul>

<h2 id="toc_2">createTable(tableName, attributes, options)</h2>

<pre><code>queryInterface.createTable(
  &#39;nameOfTheNewTable&#39;,
  {
    id: {
      type: Sequelize.INTEGER,
      primaryKey: true,
      autoIncrement: true
    },
    createdAt: {
      type: Sequelize.DATE
    },
    updatedAt: {
      type: Sequelize.DATE
    },
    attr1: Sequelize.STRING,
    attr2: Sequelize.INTEGER,
    attr3: {
      type: Sequelize.BOOLEAN,
      defaultValue: false,
      allowNull: false
    },
    //foreign key usage
    attr4: {
        type: Sequelize.INTEGER,
        references: {
            model: &#39;another_table_name&#39;,
            key: &#39;id&#39;
        },
        onUpdate: &#39;cascade&#39;,
        onDelete: &#39;cascade&#39;
    }
  },
  {
    engine: &#39;MYISAM&#39;,                     // default: &#39;InnoDB&#39;
    charset: &#39;utf8&#39;,                    // default: null
    schema: &#39;public&#39;                      // default: public, PostgreSQL only.
  }
)
</code></pre>

<h2 id="toc_3">addIndex(tableName, attributes, options)</h2>

<pre><code class="language-js">// This example will create the index person_firstname_lastname
queryInterface.addIndex(&#39;Person&#39;, [&#39;firstname&#39;, &#39;lastname&#39;])



// This example will create a unique index with the name SuperDuperIndex using the optional &#39;options&#39; field.
// Possible options:
// - indicesType: UNIQUE|FULLTEXT|SPATIAL
// - indexName: The name of the index. Default is __
// - parser: For FULLTEXT columns set your parser
// - indexType: Set a type for the index, e.g. BTREE. See the documentation of the used dialect
// - logging: A function that receives the sql query, e.g. console.log
queryInterface.addIndex(
  &#39;Person&#39;,
  [&#39;firstname&#39;, &#39;lastname&#39;],
  {
    indexName: &#39;SuperDuperIndex&#39;,
    indicesType: &#39;UNIQUE&#39;
  }
)
</code></pre>

<h2 id="toc_4">dropTable(tableName, options)</h2>

<pre><code>queryInterface.dropTable(&#39;nameOfTheExistingTable&#39;)
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[è¯‘] Sequelize(5) å‡ å¯¹å‡ ]]></title>
    <link href="http://kayorl.com/14872314142796.html"/>
    <updated>2017-02-16T15:50:14+08:00</updated>
    <id>http://kayorl.com/14872314142796.html</id>
    <content type="html"><![CDATA[
<p>ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤š</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">ä¸€å¯¹ä¸€</h2>

<h3 id="toc_1">hasOne</h3>

<h3 id="toc_2">belongsTo</h3>

<blockquote>
<p>åŒºåˆ«: <code>è”ç³»é”®</code> æ·»åŠ çš„åœ°æ–¹ä¸ä¸€æ ·</p>
</blockquote>

<pre><code class="language-js">var Player = this.sequelize.define(&#39;player&#39;, {/* attributes */}), 
    Coach  = this.sequelize.define(&#39;coach&#39;, {/* attributes */}), 
    Team  = this.sequelize.define(&#39;team&#39;, {/* attributes */}),
    Game =  this.sequelize.define(&#39;game&#39;, {/* attributes */});


Player.belongsTo(Team);     // æ·»åŠ  teamId åˆ° Player
Coach.hasOne(Team);         //æ·»åŠ  coachId åˆ° Team
</code></pre>

<p>é€šè¿‡ hasOne æ–¹æ³•æ·»åŠ çš„æ¨¡å‹</p>

<blockquote>
<p>å¯¹æ–°æ·»åŠ æ¨¡å‹çš„ setter å’Œ getter ä¼šè‡ªåŠ¨ä»¥æ¨¡å‹åä¸ºåç¼€</p>

<p>æ­¤å¤–ï¼Œä¹Ÿä¼šä»¥  <code>æ¨¡å‹å+id</code> çš„å½¢å¼ç”Ÿæˆå¤–ç </p>
</blockquote>

<p>å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç ä¿®æ”¹</p>

<pre><code class="language-js">// Person#getPerson, Person#setPerson

Person.hasOne(Person);


// å¢åŠ æ–¹æ³•Person#getFather,Person#setFather
// ä¿®æ”¹å¤–ç ä¸ºdadId

Person.hasOne(Person, {as: &#39;Father&#39;, foreignKey: &#39;dad_id&#39;})
</code></pre>

<h2 id="toc_3">ä¸€å¯¹å¤š</h2>

<pre><code class="language-js">var User = sequelize.define(&#39;user&#39;, {/* ... */})
var Project = sequelize.define(&#39;project&#39;, {/* ... */})
 
// Project#getWorkers , Project#setWorkers

Project.hasMany(User, {as: &#39;Workers&#39;})
</code></pre>

<h2 id="toc_4">å¤šå¯¹å¤š</h2>

<blockquote>
<p>ä½¿ç”¨belongToMany,ä¸ºä¸¤ä¸ªå¤šå¯¹å¤šçš„æ¨¡å‹å»ºç«‹è”ç³»</p>

<p>é€šè¿‡åˆ›å»ºä¸€ä¸ªä¸­é—´æ¨¡å‹<code>(è”ç³»é›†)</code>å®ç°</p>
</blockquote>

<pre><code class="language-js">User = sequelize.define(&#39;user&#39;, {})
Project = sequelize.define(&#39;project&#39;, {})
UserProjects = sequelize.define(&#39;userProjects&#39;, {
    id: {
        type: Sequelize.INTEGER,
        primaryKey: true,
        autoIncrement: true
    },
    status: DataTypes.STRING
})
 
User.belongsToMany(Project, {  as: &#39;Tasks&#39;, through: UserProjects, foreignKey: &#39;userId&#39; })
Project.belongsToMany(User, {  as: &#39;Workers&#39;,through: UserProjects ,foreignKey: &#39;projectId&#39;})


// æ·»åŠ ä¸€ä¸ª project, å¹¶ä¸”,è®¾ç½®å…¶çŠ¶æ€ä¸º started

user.addProject(project, { status: &#39;started&#39; })


// ä½¿ç”¨ through å¯ä»¥é€‰æ‹©ç‰¹å®šå±æ€§

User.findAll({
  include: [{
    model: Project,
    through: {
      attributes: [&#39;createdAt&#39;, &#39;startedAt&#39;, &#39;finishedAt&#39;],
      where: {completed: true}
    }
  }]
});
</code></pre>

<blockquote>
</blockquote>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[è¯‘] Sequelize(4) èŒƒå›´]]></title>
    <link href="http://kayorl.com/14872314142644.html"/>
    <updated>2017-02-16T15:50:14+08:00</updated>
    <id>http://kayorl.com/14872314142644.html</id>
    <content type="html"><![CDATA[
<p>èŒƒå›´ï¼ˆ<code>scope</code>ï¼‰: å®šä¹‰å¥½èŒƒå›´,åœ¨åç»­çš„æ“ä½œä¸­å¯ä»¥å‡å°‘é€‰æ‹©æ¡ä»¶çš„é‡å¤ï¼Œæ¯”å¦‚ï¼Œåªåœ¨<strong>æœªåˆ é™¤ç”¨æˆ·</strong>åˆ—è¡¨ä¸­è¿›è¡Œæ“ä½œã€‚</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">èŒƒå›´æ˜¯å¯¹æ¨¡å‹çš„ä¸€ç§åˆ†ç±»</h2>

<pre><code class="language-js">// ä¿®æ”¹é»˜è®¤æ‰€æœ‰æ“ä½œçš„èŒƒå›´ default Scope
var Project = sequelize.define( &#39;project&#39;, {
    // Attributes
}, {
    defaultScope: {
        where: {
            active: true
        }
    },
    scopes: {
        deleted: {
            where: {
                deleted: true
            }
        },
        activeUsers: {
            include: [
                { model: User, where: { active: true } }
      ]
        }
    }
} );



// ç§»é™¤é»˜è®¤èŒƒå›´ï¼Œè®¾ç½®ä¸º deleted èŒƒå›´
Project.scope( &#39;deleted&#39; ).findAll();

// ä¸ä¸Šé¢ç­‰ä»·
var DeletedProjects = Project.scope( &#39;deleted&#39; );
DeletedProjects.findAll();

var Post = sequelize.define( &#39;post&#39;, attributes, {
    defaultScope: {
        where: {
            active: true
        }
    },
    scopes: {
        deleted: {
            where: {
                deleted: true
            }
        }
    }
} );
</code></pre>

<h2 id="toc_1">ä¾‹å­</h2>

<pre><code class="language-js">User.hasMany( Post ); // regular getPosts association
User.hasMany( Post.scope( &#39;deleted&#39; ), { as: &#39;deletedPosts&#39; } );
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[è¯‘] Sequelize(3)  CRUD]]></title>
    <link href="http://kayorl.com/14872314142502.html"/>
    <updated>2017-02-16T15:50:14+08:00</updated>
    <id>http://kayorl.com/14872314142502.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<h2 id="toc_0">æ¨¡å‹å®šä¹‰</h2>

<pre><code class="language-js">var Task = sequelize.define( &#39;task&#39;, {
    title: Sequelize.STRING,
    rank: { type: Sequelize.STRING, defaultValue: 3 }
} );
</code></pre>

<h2 id="toc_1">Create</h2>

<pre><code class="language-js">// åˆ›å»ºæ•°æ®åº“ä¸­å¯¹è±¡
Task.create( { title: &#39;foo&#39; } );

// åˆ›å»ºä¸´æ—¶å˜é‡
var task = Task.build( { title: &#39;very important task&#39; } );

// å°†ä¸´æ—¶å˜é‡å­˜å…¥æ•°æ®åº“å†…, åªä¿å­˜ title å±æ€§
task.save( { fields: [ &#39;title&#39; ] } );
</code></pre>

<h2 id="toc_2">Update</h2>

<pre><code class="language-js">// åœ¨æ•°æ®åº“ä¸­æ›´æ–° task çš„ title
task.update( { title: &#39;a very different title now&#39; } );


// æ›´æ–° æ’åå°äº1000æˆ–è€…æ— æ’åçš„ post çš„ updateAt ä¸º null
Post.update( {
    updatedAt: null,
}, {
    where: {
        rank: {
            $or: {
                $lt: 100,
                $eq: null
            }
        }
    }
    //// rank &lt; 1000 OR rank IS NULL
} );
</code></pre>

<h2 id="toc_3">Delete</h2>

<pre><code class="language-js">// åˆ é™¤ ä¸æ´»è·ƒçš„ post
Post.destroy( {
    where: {
        status: &#39;inactive&#39;
    }
} );
</code></pre>

<h2 id="toc_4">Retrieve</h2>

<pre><code class="language-js">// åªé€‰æ‹©ç›¸åº”å±æ€§
Model.findAll( {
    attributes: [ &#39;foo&#39;, &#39;bar&#39; ]
} );
// åšèšç±»
Model.findAll( {
    attributes: { include: [ [ sequelize.fn( &#39;COUNT&#39;, sequelize.col( &#39;hats&#39; ) ), &#39;no_hats&#39; ] ] }
} );
// é™¤å¼€æŸäº›å±æ€§
Model.findAll( {
    attributes: { exclude: [ &#39;baz&#39; ] }
} );

// id æŸ¥æ‰¾
Project.findById( 123 ).then();

// å±æ€§æŸ¥æ‰¾
Project.findOne( { where: { title: &#39;aProject&#39; } } ).then();
// ï¼Ÿ
Project.findOne( { where: { title: &#39;aProject&#39; }, attributes: [ &#39;id&#39;, [ &#39;name&#39;, &#39;title&#39; ] ] } ).then();

// æ‰¾ï¼Œæ— åˆ™åˆ›å»ºï¼Œ created ä¸º boolean
User.findOrCreate( { where: { username: &#39;kayor&#39; } } ).spread( function ( user, created ) {} );

// æ‰¾å¹¶ä¸”è®¡æ•° count ä¸ºè®¡æ•°ï¼Œ rows ä¸ºå¯¹è±¡æ•°ç»„
Project.findAndCountAll( {
    where: { title: { $like: &#39;foo%&#39; } },
    offset: 10,
    limit: 2
} ).then( function ( result ) {
    console.log( result.count );
    console.log( result.rows );
} );

// æ‰¾å‡ºæ‹¥æœ‰ active profile çš„ç”¨æˆ·
User.findAndCountAll( {
    include: [
        { model: Profile, where: { active: true } }
  ],
    limit: 3
} );


Project.findAll();
Project.all();
Project.findAll( { where: { name: &quot;a Project&quot; } } );
Project.findAll( { where: [ &quot;id&gt;?&quot;, 25 ] } );
Project.findAll( { where: { id: [ 1, 2, 3 ] } } );
Project.findAll( {
    where: {
        id: {
            $and: { a: 5 },
            $or: [ { a: 5 }, { a: 6 } ],
            $gt: 6,
            $gte: 6,
            $lt: 10,
            $lte: 10,
            $ne: 20,
            $between: [ 6, 10 ],
            $notBetween: [ 6, 10 ],
            $in: [ 1, 2 ],
            $notIn: [ 1, 2 ],
            $like: &#39;%hat&#39;
        },
        status: { $not: false }
    }
} );

//åªæ‰¾åä¸ª
Project.findAll( { limit: 10 } );
// è·³è¿‡å‰10ä¸ª
Project.findAll( { offset: 10 } );
// è·³è¿‡å‰10ï¼Œå–ä¸¤ä¸ª
Project.findAll( { offset: 10, limit: 2 } );

// é€’å‡
Project.findAll( { order: &#39;title DESC&#39; } );
// åˆ†ç»„
Project.findAll( { group: &#39;name&#39; } );
// è®¡æ•°
Project.count( { where: [ &quot;id&gt;?&quot;, 25 ] } );
// æ‰¾æœ€å¤§
Project.max( &#39;age&#39; );

// å†…è¿æ¥æ‰¾åˆ°æ‹¥æœ‰ç¬¦åˆæ¡ä»¶å·¥å…·çš„ç”¨æˆ·
Post.findAll( {
    include: [ {
        model: Comment,
        as: &#39;comment_my&#39;,
        where: { name: { $like: &#39;%ooth%&#39; } }
    } ]
} );

// è·å¾—åŸæ•°æ®
Post.findOne( { where: { title: &#39;scut&#39; } } ).then( function ( post ) {
    post.title = &#39;south china university of tecknology&#39;;
    console.log( post.title ); // &#39;south china university of tecknology&#39;

    post.reload().then( function () {
        console.log( post.title ); // &#39;scut&#39;
    } );
} );

</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[supertest æ¨¡æ‹Ÿå®¢æˆ·ç«¯]]></title>
    <link href="http://kayorl.com/14872476184764.html"/>
    <updated>2017-02-16T20:20:18+08:00</updated>
    <id>http://kayorl.com/14872476184764.html</id>
    <content type="html"><![CDATA[
<p>æ¨¡æ‹Ÿä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå¯ç”¨äºçˆ¬è™«ã€API æµ‹è¯•ç­‰</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">å®‰è£…</h2>

<pre><code>$ npm install supertest --save-dev
</code></pre>

<h2 id="toc_1">ä¾‹å­</h2>

<pre><code class="language-js">var request = require(&#39;supertest&#39;);
var express = require(&#39;express&#39;);

var app = express();

app.get(&#39;/user&#39;, function(req, res) {
  res.status(200).json({ name: &#39;tobi&#39; });
});

request(app)
  .get(&#39;/user&#39;)
  .expect(&#39;Content-Type&#39;, /json/)
  .expect(&#39;Content-Length&#39;, &#39;15&#39;)
  .expect(200)
  .end(function(err, res) {
    if (err) throw err;
  });
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pm2]]></title>
    <link href="http://kayorl.com/14872295003201.html"/>
    <updated>2017-02-16T15:18:20+08:00</updated>
    <id>http://kayorl.com/14872295003201.html</id>
    <content type="html"><![CDATA[
<p>nodejs çš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œè‡ªå¸¦<code>è´Ÿè½½å‡è¡¡</code>ä»¥åŠçƒ­é‡è½½</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">å…¨å±€å®‰è£…</h2>

<pre><code>$ npm install pm2 -g
</code></pre>

<h2 id="toc_1">å¼€æœºå¯åŠ¨</h2>

<p>pm2 save ä¿å­˜å½“å‰è¿›ç¨‹åˆ—è¡¨ï¼Œä¸‹æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨æ¢å¤åˆ—è¡¨å†…è¿›ç¨‹</p>

<pre><code>$ pm2 startup &amp;&amp; pm2 save
</code></pre>

<h2 id="toc_2">å¯åŠ¨</h2>

<blockquote>
<p>[ app_name ] : åº”ç”¨å<br/>
[ 4 ] :è¿›ç¨‹æ•°ç›®,ä¸º0æ—¶è¿›ç¨‹æ•°ç›®ä¸ CPU æ•°ç›¸ç­‰</p>
</blockquote>

<pre><code>$ pm2 start app.js --name=[app_name] -i 4
</code></pre>

<h2 id="toc_3">æš‚åœ | åˆ é™¤</h2>

<blockquote>
<p>[ id ] : è¿›ç¨‹ id</p>
</blockquote>

<pre><code>$ pm2 stop [id]
$ pm2 delete [id]
</code></pre>

<p>è¿›ç¨‹æ•°å˜ä¸º2</p>

<blockquote>
<p>[ app_name ] : åº”ç”¨å</p>
</blockquote>

<pre><code>$ pm2 sacle [app_name] 2
</code></pre>

<h2 id="toc_4">ç›‘æ§</h2>

<pre><code>$ pm2 list
$ pm2 monit
$ pm2 show [app_name]
$ pm2 logs
$ pm2 logs [app_name]
</code></pre>

<hr/>

<p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ <a href="https://app.keymetrics.io">keymetrics</a>  å®ç°ç½‘é¡µç›‘æ§ï¼Œä¸è¿‡å…è´¹ç‰ˆåªèƒ½æ”¯æŒä¸€å°æœºå™¨çš„çŠ¶æ€ç›‘æ§</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[nginx ä»å®‰è£…åˆ°å¸è½½]]></title>
    <link href="http://kayorl.com/14872295003080.html"/>
    <updated>2017-02-16T15:18:20+08:00</updated>
    <id>http://kayorl.com/14872295003080.html</id>
    <content type="html"><![CDATA[
<p>åœ¨<code>ubuntu16.04</code>ä¸‹ï¼Œå¯¹ nginx è¿›è¡Œ</p>

<ul>
<li>
<a href="#toc_0">æºå®‰è£…</a>
</li>
<li>
<a href="#toc_1">é…ç½®é˜²ç«å¢™å…è®¸ nginx é€šè¿‡ 80 ç«¯å£</a>
</li>
<li>
<a href="#toc_2">æŸ¥çœ‹ nginx çŠ¶æ€</a>
</li>
<li>
<a href="#toc_3">å†…æ ¸å‚æ•°ä¼˜åŒ–</a>
</li>
<li>
<a href="#toc_4">ä½¿é…ç½®ç”Ÿæ•ˆ</a>
</li>
<li>
<a href="#toc_5">nginx é…ç½®</a>
</li>
</ul>


<span id="more"></span><!-- more -->

<p>å‚è€ƒå¾ˆå…¨é¢çš„<a href="http://bbs.linuxtone.org/thread-25588-1-1.html">æ•™ç¨‹</a>ï¼Œå…³äº nginx çš„ä¼˜åŒ–ï¼Œä»¥åŠè‡ªå·±å¹³å¸¸é‡åˆ°çš„é—®é¢˜</p>

<h2 id="toc_0">æºå®‰è£…</h2>

<pre><code>sudo apt-get update
sudo apt-get install nginx 

# å®‰è£…å¸¸ç”¨ nginx æ’ä»¶
apt-get install nginx-extras 
</code></pre>

<h2 id="toc_1">é…ç½®é˜²ç«å¢™å…è®¸ nginx é€šè¿‡ 80 ç«¯å£</h2>

<pre><code>sudo ufw app list 
sudo ufw allow &#39;Nginx HTTP&#39; 
sudo ufw status
</code></pre>

<h2 id="toc_2">æŸ¥çœ‹ nginx çŠ¶æ€</h2>

<pre><code>systemctl status nginx
</code></pre>

<h2 id="toc_3">å†…æ ¸å‚æ•°ä¼˜åŒ–</h2>

<pre><code>#vi /etc/sysctl.conf
net.ipv4.netfilter.ip_conntrack_tcp_timeout_established = 1800
net.ipv4.ip_conntrack_max = 16777216ã€€ï¼ƒã€€å¦‚æœä½¿ç”¨é»˜è®¤å‚æ•°,å®¹æ˜“å‡ºç°ç½‘ç»œä¸¢åŒ…
net.ipv4.netfilter.ip_conntrack_max = 16777216ï¼ƒã€€å¦‚æœä½¿ç”¨é»˜è®¤å‚æ•°,å®¹æ˜“å‡ºç°ç½‘ç»œä¸¢åŒ…
net.ipv4.tcp_max_syn_backlog = 65536
net.core.netdev_max_backlog =  32768
net.core.somaxconn = 32768
net.core.wmem_default = 8388608
net.core.rmem_default = 8388608
net.core.rmem_max = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_timestamps = 0
net.ipv4.tcp_synack_retries = 2
net.ipv4.tcp_syn_retries =
net.ipv4.tcp_tw_recycle = 1
net.ipv4.tcp_tw_reuse = 1
net.ipv4.tcp_mem = 94500000 915000000 927000000
net.ipv4.tcp_max_orphans = 3276800
net.ipv4.ip_local_port_range = 1024  65535
</code></pre>

<h2 id="toc_4">ä½¿é…ç½®ç”Ÿæ•ˆ</h2>

<pre><code># sysctl -p
</code></pre>

<h2 id="toc_5">nginx é…ç½®</h2>

<pre><code># vi /etc/nginx/nginx.conf

worker_processes auto;  #å¼€å¯å·¥ä½œè¿›ç¨‹ï¼Œå¤šå°‘æ ¸å¿ƒå°±å¤šå°‘ä¸ª
pid /run/nginx.pid;     #pid è·¯å¾„
worker_rlimit_nofile 100000; #æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°é™åˆ¶ï¼Œè§£å†³&#39;too many open files&#39;é—®é¢˜

events {
        worker_connections 2048;   #ä¸€ä¸ªè¿›ç¨‹èƒ½åŒæ—¶å¤„ç†2048ä¸ªè¯·æ±‚
        multi_accept on;    #æ¥æ”¶åˆ°ä¸€ä¸ªæ–°è¿æ¥åå°½å¯èƒ½å¤šé“¾æ¥
        # use epoll;    #*BSD ç”¨ kqueueï¼Œå…¶ä»–ç”¨ epollï¼Œä¸æè¿°çš„è¯ï¼Œè‡ªåŠ¨é€‰æ‹©é€‚åˆæ“ä½œç³»ç»Ÿåœ°
}

http {

        ##
        # Basic Settings
        ##

        server_tokens off;      #ä¸å‘ç”¨æˆ·å±•ç¤º Nginx ç‰ˆæœ¬ï¼Œä¿è¯å®‰å…¨

        sendfile on;            #é™æ€æœåŠ¡å™¨å¯ç”¨ï¼Œ
        tcp_nopush on;          #åœ¨ä¸€ä¸ªæ•°æ®åŒ…é‡Œå‘é€æ‰€æœ‰å¤´æ–‡ä»¶ï¼Œä¸ä¸€ä¸ªä¸€ä¸ªå‘é€
        tcp_nodelay on;         #ä¸ç¼“å­˜ï¼Œç›´æ¥å‘é€


        ##
        #Timeout Settings
        ##
        keepalive_timeout 10;   #æœåŠ¡å™¨åœ¨è¶…æ—¶æ—¶é—´è¿‡åå…³é—­é“¾æ¥
        client_header_timeout 10;
        client_body_timeout 10;
        reset_timedout_connection on; #å…³é—­ä¸å“åº”çš„å®¢æˆ·ç«¯è¿æ¥
        send_timeout 10;        #å®¢æˆ·ç«¯çš„å“åº”è¶…æ—¶æ—¶

        types_hash_max_size 2048;

        ##
        #1 user connection limit
        ##
        limit_conn_zone $binary_remote_addr zone=addr:5m;       #ä¿å­˜å½“å‰è¿æ¥æ•°çš„å…±äº«å†…å­˜
        limit_conn addr 100;    #åŒä¸€ä¸ª ip æœ€å¤š100ä¸ªè¿æ¥

        # server_names_hash_bucket_size 64;
        # server_name_in_redirect off;

        include /etc/nginx/mime.types;
        default_type application/octet-stream;

        ##
        #Log Settings
        access_log off;
        error_log /var/log/nginx/error.log;


        ##
        # SSL Settings
        ##

        ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE
        ssl_prefer_server_ciphers on;


        ##
        # Gzip Settings
        ##

        gzip on;
        gzip_disable &quot;msie6&quot;;   #å¯¹ IE6 åŠä»¥ä¸‹çš„ç‰ˆæœ¬ç¦ç”¨ gzip
         # gzip_static on;
        # gzip_vary on;
          gzip_proxied any; #å‹ç¼©æ‰€æœ‰è¯·æ±‚
          gzip_min_length 1000;å¯ç”¨å‹ç¼©çš„æœ€å°‘å­—èŠ‚æ•°ï¼Œå°äº1000ä¸å‹ç¼©
          gzip_comp_level 4;    #å‹ç¼©æ¯”ï¼Œ9æœ€æ…¢ä½†å‹ç¼©æœ€å¼º
        # gzip_buffers 16 8k;
        # gzip_http_version 1.1;
          gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

        ##
        #Open File Cache Settings
        ##

        open_file_cache max=100000 inactive=20s;    #æ‰“å¼€ç¼“å­˜çš„åŒæ—¶ï¼Œå½“20ç§’ä¸æ´»åŠ¨æ—¶æ¸…é™¤æ‰
        open_file_cache_valid 30s;
        open_file_cache_min_uses 2;
        open_file_cache_errors on;


        #Virtual Host Configs
        include /etc/nginx/conf.d/*.conf;
}
</code></pre>

<blockquote>
<p>å¸è½½ nginx</p>
</blockquote>

<pre><code>sudo apt-get remove nginx nginx-common # Removes all but config files.
sudo apt-get purge nginx nginx-common # Removes everything.
sudo apt-get autoremove # After using any of the above commands, use this in order to remove dependencies used by nginx which are no longer required.
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(11) åè®®]]></title>
    <link href="http://kayorl.com/14872504904620.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504904620.html</id>
    <content type="html"><![CDATA[
<p>é‡‡ç”¨åè®®å°±æ˜¯åœ¨ç±»çš„@ interface å£°æ˜ä¸­åˆ—å‡ºåè®®çš„åç§°<br/>
æ˜¾å¼åœ°é‡‡ç”¨ï¼Œæ‰¿è¯ºå®ç°è¯¥åè®®çš„æ‰€æœ‰æ–¹æ³•,å¦åˆ™,ç¼–è¯‘å™¨ä¼šæ‰¾éº»çƒ¦</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">å£°æ˜åè®®</h2>

<pre><code class="language-objc">@protocal NSCopying &lt;NSObject&gt;      
- (id) copyWithZone: (NSZone *) zone;
@end
</code></pre>

<ul>
<li>NSObject åœ¨è¿™é‡Œæ˜¯ä¸€ç§åè®®</li>
<li>å°–å°–æ‹¬å·è¡¨ç¤ºç»§æ‰¿</li>
<li>åè®®ä¸­ä¸å¼•å…¥æ–°çš„å®ä¾‹å˜é‡</li>
<li>è·Ÿ<code>æ¥å£</code>çš„æ„Ÿè§‰å¥½åƒè¯¶</li>
</ul>

<h2 id="toc_1">é‡‡ç”¨åè®®</h2>

<pre><code class="language-objc">@interface Car : NSObject &lt;NSCopying,NSCoding&gt;
{
    ...
}
@end
</code></pre>

<ul>
<li>è¿™å°±é‡‡ç”¨äº†åè®®äº†,å‘Šè¯‰äººä»¬,è¿™è¾†è½¦å¯ä»¥è¢«å¤åˆ¶,å¯ä»¥è¢«ç¼–ç </li>
</ul>

<h2 id="toc_2">å®ç°åè®®</h2>

<ul>
<li><code>æµ…å±‚å¤åˆ¶</code>:åªå¤åˆ¶æŒ‡å‘ç°æœ‰çš„å¼•ç”¨å¯¹è±¡,ä¸ä¼šå¤åˆ¶å¼•ç”¨å¯¹è±¡çš„æœ¬èº«</li>
<li><code>æ·±å±‚å¤åˆ¶</code>:å¤åˆ¶æ‰€æœ‰çš„å¼•ç”¨å¯¹è±¡</li>
</ul>

<h2 id="toc_3">å¤åˆ¶ Engine</h2>

<p>ä¸ºäº†èƒ½å¤Ÿå¤åˆ¶ engine å¯¹è±¡, Engine ç±»éœ€è¦é‡‡ç”¨ NSCopying åè®®</p>

<pre><code class="language-objc">@interface Engine : NSObject &lt;NSCopying&gt;
@end    //Engine
</code></pre>

<p>å› ä¸º Engine ç±»é‡‡ç”¨äº† NSCopying åè®®, æ‰€ä»¥ Engine ç±»éœ€è¦å®ç° copyWithZone æ–¹æ³•</p>

<pre><code class="language-objc">@implementation Engine

- (id) copyWithZone: (NSZone *) zone
{
    Engine *engineCopy;
    engineCopy = [ [ [self class] allocWithZone: zone] init];
    return (engineCopy);
}
</code></pre>

<ul>
<li>å¤åˆ¶çš„æ—¶å€™, engine å¹¶æ²¡æœ‰å®ä¾‹å˜é‡,å› æ­¤,æˆ‘ä»¬è¦è·å¾—ä¸€ä¸ªæ–°çš„ engine å¯¹è±¡</li>
<li>copyWIthZone æ˜¯ä¸€ä¸ªç±»æ–¹æ³•</li>
<li>å…¼é¡¾åˆ° Engine çš„å­ç±»åœ¨åˆ›å»ºå¯¹è±¡æ—¶,åªä¼šç”Ÿæˆ Engine ç±»çš„å¯¹è±¡,è€Œä¸æ˜¯å…¶å­ç±»çš„å¯¹è±¡,æ‰€ä»¥,è¿™æ ·åšèƒ½å¤Ÿé¢„é˜²å†…å­˜æº¢å‡º</li>
<li>å­ç±»ä¸ç”¨å®ç° copyWithZone æ–¹æ³•</li>
</ul>

<h2 id="toc_4">åè®®å’Œæ•°æ®ç±»å‹</h2>

<p>idç±»å‹æ˜¯ä¸€ä¸ªæ³›å‹å¯¹è±¡ç±»å‹,å¯ä»¥å°†ä»»ä½•å¯¹è±¡å¤åˆ¶ç»™ä¸€ä¸ª id ç±»å‹çš„å˜é‡.</p>

<p>ç”¨å°–æ‹¬å·æ‹¬èµ·æ¥çš„åè®®è·Ÿéšåœ¨ id ä¹‹å,åˆ™ç¼–è¯‘å™¨å°†çŸ¥é“è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä»»æ„ç±»å‹çš„å¯¹è±¡,å‰ææ˜¯éµå®ˆè¯¥åè®®</p>

<pre><code class="language-objc">- (void) setObjectValue: (id&lt;NSCopying&gt;) object;
</code></pre>

<hr/>

<h2 id="toc_5">@optional å’Œ @require</h2>

<pre><code class="language-objc">@protocal BaseballPlayer;
- (void) drawHugeSalary;        //å¿…é¡»å®ç°

@optional       //å¯ä»¥é€‰æ‹©å®ç°
- (void) slideHome;
- (void) catchBall;
- (void) throwBall;

@require        //å¿…é¡»å®ç°
- (void) swingBat;
@end;
</code></pre>

<hr/>

<h2 id="toc_6">å§”æ‰˜æ–¹æ³•</h2>

<p>ä¹¦ä¸Šå†™çš„ä¸è¯¦ç»†å•Š</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(10) ç±»åˆ«]]></title>
    <link href="http://kayorl.com/14872504904501.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504904501.html</id>
    <content type="html"><![CDATA[
<p>åˆ©ç”¨ OC çš„åŠ¨æ€è¿è¡Œæ—¶åˆ†é…æœºåˆ¶,å¯ä»¥ä¸ºç°æœ‰çš„ç±»æ·»åŠ æ–°æ–¹æ³•(æ— æ³•æ·»åŠ å˜é‡)<br/>
åœ¨ OC é‡Œ, è¿™äº›æ–¹æ³•å«åšç±»åˆ« (category)</p>

<span id="more"></span><!-- more -->

<pre><code class="language-objc">@interface NSString (NumberConvinience)
- (NSNumber *) lengthAsNumber;
...
@end

/****************** *****************/

#import &quot;NSString+NumberConvinience.h&quot;


@implementation NSString (NumberConvinience)
- (NSNumber *) lengthAsNumber
{
    NSInteger length = [self length];
    return ([NSNumber numberWithUnsignedInteger:length]);
}
@end
</code></pre>

<ul>
<li><p>NSIntegerã€NSUIntegerã€CGFLoatä¸æ˜¯åŒ…è£…ç±»ï¼Œè™½ç„¶ä»–ä»¬å¸¦æœ‰NSã€CGå‰ç¼€ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯åŒ…è£…ç±»ï¼Œåªæ˜¯<code>åŸºæœ¬ç±»å‹</code>ï¼Œå®ƒä»¬åˆ†åˆ«å¤§è‡´ç­‰äºï¼šlongã€unsigned longå’Œdoubleï¼ˆæˆ–floatï¼‰</p></li>
<li><p><code>ä»»ä½•</code> NSString éƒ½èƒ½ç›¸åº” lengthAsNumber ä¿¡æ¯</p></li>
<li><p>ç¼ºé™·: å­˜åœ¨<code>åç§°å†²çª</code>,ä¸ç°æœ‰çš„æ–¹æ³•é‡åæ—¶,ç±»åˆ«æ–¹æ³•å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§</p></li>
</ul>

<h3 id="toc_0">ç±»åˆ«çš„ä¼˜åŠ¿</h3>

<ol>
<li>å¯ä»¥å°†ç±»çš„å®ç°ä»£ç åˆ†æ•£åˆ°å¤šä¸ªä¸åŒæ–‡ä»¶æˆ–æ¡†æ¶ä¸­</li>
<li>åˆ›å»ºå¯¹ç§æœ‰æ–¹æ³•çš„å‰å‘å¼•ç”¨</li>
<li>å‘å¯¹è±¡æ·»åŠ éæ­£å¼åè®®</li>
</ol>

<h2 id="toc_1">ç±»æ‰©å±•</h2>

<p>ä¸éœ€è¦åå­—çš„ç±»åˆ«,å¯ä»¥æ·»åŠ å®ä¾‹å˜é‡,æ”¹å˜åªè¯»æƒé™</p>

<ul>
<li>( )åªæ˜¯è·å– thing ç±»</li>
<li>ç”¨æ¥<code>ä¿¡æ¯éšè—</code></li>
</ul>

<pre><code class="language-objc">@interface thing: NSObject
@property (assign) NSInteger thing1;
@property (readonly,assign) NSInteger thing2;
...
@end

/********** å˜å½¢çº¿  ********/

@interface thing ()
{
    NSInteger thing4;
}
@property (assign) NSInteger thing1;
@property (readWrite,assign) NSInteger thing2;
...
@end

</code></pre>

<h2 id="toc_2">ä¼˜åŠ¿1: ç”¨ç±»åˆ«åˆ†æ•£ä»£ç </h2>

<pre><code class="language-objc">@interface CategoryThing : NSObject
{
    NSInteger thing1;
    NSInteger thing2;
    NSInteger thing3;
}
@end

@interface CategortThing (Thing1)
- (void) setThing1: (NSInteger) things1;
- (NSInteger)things1;
...
@end

</code></pre>

<p>ä»¥ä¸Šæ˜¯å¤´æ–‡ä»¶ä¸­çš„å†…å®¹,ä¸‹é¢æ˜¯ç±»åˆ« Thing1.m æ–‡ä»¶çš„å†…å®¹</p>

<pre><code class="language-objc">#import &quot;CategoryThing.h&quot;
@implementation CategoryThing (Thing1)
- (void)setThing1:(NSInteger)t1
{
    thing1=t1;
}
@end;
</code></pre>

<h2 id="toc_3">ä¼˜åŠ¿2: åˆ›å»ºå‰å‘å¼•ç”¨</h2>

<p>ç±»åˆ«ä¸­å£°æ˜ä½†åœ¨ç±»ä¸­æ²¡æœ‰å£°æ˜çš„æ–¹æ³•,ç¼–è¯‘å™¨ä¼šè­¦å‘Š,è§£å†³é—®é¢˜çš„ç­–ç•¥æ˜¯:</p>

<blockquote>
<p>å°†ç±»åˆ«ç½®äºå®ç°æ–‡ä»¶çš„æœ€å‰é¢</p>
</blockquote>

<pre><code class="language-objc">@interface Car (Private)
{
    //å…¶ä»–ç±»åˆ«ä¸­æƒ³ä½¿ç”¨çš„æ–¹æ³•
}
@end

@implemention Car
{
...
}
@end
</code></pre>

<h2 id="toc_4">ä¼˜åŠ¿3:éæ­£å¼åè®®å’Œå§”æ‰˜ç±»åˆ«</h2>

<p>æ©,æš‚æ—¶è·³è¿‡,æ„Ÿè§‰ä¸ä¸¥è°¨</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[æ‚]]></title>
    <link href="http://kayorl.com/14872477973050.html"/>
    <updated>2017-02-16T20:23:17+08:00</updated>
    <id>http://kayorl.com/14872477973050.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<h2 id="toc_0">Nodejs <a href="node-production">ç”Ÿäº§æ¨¡å¼</a></h2>

<h2 id="toc_1">é…ç½® openssl å¯†ç å¼€å…³</h2>

<pre><code>$ vi /etc/ssh/sshd_config
$ sudo systemctl reload sshd
</code></pre>

<h2 id="toc_2">Redis</h2>

<p><a href="http://www.linuxdiyf.com/linux/22527.html">http://www.linuxdiyf.com/linux/22527.html</a></p>

<h2 id="toc_3">Mac å¯åŠ¨ redis</h2>

<pre><code>$ sudo ../bin/redis-server ./redis.conf
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(9) å±æ€§]]></title>
    <link href="http://kayorl.com/14872504904341.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504904341.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<h2 id="toc_0">@property</h2>

<p>é¢„ç¼–è¯‘æŒ‡ä»¤, è‡ªåŠ¨å£°æ˜å±æ€§çš„ setter å’Œ getter æ–¹æ³•</p>

<pre><code>@interface Cube :
{
    float length;
    float height;
}
@property float length;
@property float height;
...
@end
</code></pre>

<h2 id="toc_1">@synthesize</h2>

<ul>
<li>Xcode4.5 ä¹‹åä¸å¿…ä½¿ç”¨@synthesize</li>
<li>åˆ›å»ºäº†è¯¥å±æ€§çš„è®¿é—®ä»£ç ,ç¼–è¯‘å™¨å°†è‡ªåŠ¨æ·»åŠ  setLength, getLengthç­‰æ–¹æ³• </li>
</ul>

<pre><code>@implementation Cube
@synthesize length;
@synthesize height;
...
@end
</code></pre>

<h3 id="toc_2">å˜é‡è¯¥åœ¨ å¤´æ–‡ä»¶ è¿˜æ˜¯ å®ç°æ–‡ä»¶ ä¸­å£°æ˜?</h3>

<ol>
<li>å˜é‡æƒ³è¢«å­ç±»ç›´æ¥é€šè¿‡å±æ€§æ¥è®¿é—®,é‚£å°±æ”¾åœ¨å¤´æ–‡ä»¶ä¸­</li>
<li>å˜é‡åªé™äºå½“å‰ç±», åˆ™æ”¾åœ¨å®ç°æ–‡ä»¶ä¸­</li>
</ol>

<h2 id="toc_3">ç‚¹è¡¨è¾¾å¼</h2>

<p>ç‚¹è¡¨è¾¾å¼å‡ºç°åœ¨è¡¨è¾¾å¼å·¦è¾¹,åˆ™æ˜¯ setter æ–¹æ³•çš„è°ƒç”¨; åœ¨å³è¾¹, åˆ™æ˜¯ getter æ–¹æ³•çš„è°ƒç”¨</p>

<pre><code>car.engine=[Engine new];    //setter
benz.engine = car.engine;   //getter
</code></pre>

<h2 id="toc_4">å±æ€§æ‰©å±•</h2>

<ul>
<li>name ä½¿ç”¨äº† copy ç‰¹æ€§,æ‰€ä»¥ç¼–è¯‘å™¨å’Œç±»çš„ä½¿ç”¨è€…ä¼šçŸ¥é“ name å±æ€§å°†è¢«å¤åˆ¶.</li>
<li>å› æ­¤,åœ¨å®ç°ä¸­, name å±æ€§å°†ä¼šè‡ªåŠ¨åˆ©ç”¨ copy çš„ç‰¹æ€§å»å¤åˆ¶å­—ç¬¦ä¸²</li>
<li>engine ä½¿ç”¨çš„æœ‰ä¿ç•™å’Œé‡Šæ”¾ç‰¹æ€§</li>
</ul>

<pre><code class="language-objc">@class Tire
@class Engine
@interface Car : NSObject
{
    NSString *name;
    NSMutableArray *tires;
    Engine *engine;
}

@property (copy) NSString *name;
@property (retain) Engine *engine;
...
@end


@implmentation Car
...

@synthesize name;
@synthesize engine;

@end
</code></pre>

<h2 id="toc_5">åªè¯»å±æ€§</h2>

<h4 id="toc_6">æ€ä¹ˆèµ‹å€¼åªè¯»å±æ€§å‘¢?</h4>

<p>é»˜è®¤æƒ…å†µä¸‹,å±æ€§æ˜¯å¯å˜çš„.å¦‚æœä¸æƒ³ä»»ä½•äººæˆ‘éœ€æ”¹è¿™ä¸ªå±æ€§å¯ä»¥ä½¿ç”¨ <code>readOnly</code> ç‰¹æ€§,è¿™æ ·,<br/>
ç¼–è¯‘å™¨ä¼šç”Ÿæˆ getter æ–¹æ³•è€Œä¸ä¼šç”Ÿæˆ setter æ–¹æ³•.</p>

<h2 id="toc_7">åŠ¨æ€å±æ€§</h2>

<p>é€šè¿‡ä½¿ç”¨<code>@dynamic</code> æŒ‡ä»¤æ¥æŒ‡å®šå±æ€§å¹¶å‘Šè¯‰ç¼–è¯‘å™¨ä¸è¦åˆ›å»ºå˜é‡æˆ– getter æ–¹æ³•,åˆ›å»ºå‡ºèƒ½åœ¨è¿è¡Œæ—¶è®¡ç®—å€¼çš„æ–¹æ³•</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(8) å¯¹è±¡åˆå§‹åŒ–]]></title>
    <link href="http://kayorl.com/14872504904170.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504904170.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<h2 id="toc_0">åˆ†é…å¯¹è±¡</h2>

<p>å‘æŸä¸ªç±»å‘é€ alloc æ¶ˆæ¯,ä»æ“ä½œç³»ç»Ÿè·å¾—ä¸€å—å†…å­˜,ç”¨æ¥å­˜å‚¨è¯¥<code>ç±»</code>çš„å…¨éƒ¨å®ä¾‹å˜é‡,å¹¶ä¸”å…¨éƒ¨åˆå§‹åŒ–ä¸º0</p>

<h2 id="toc_1">åˆå§‹åŒ–å¯¹è±¡</h2>

<p>ä¸åˆ†é…å¯¹åº”çš„æ“ä½œæ˜¯åˆå§‹åŒ–,åˆå§‹åŒ–ä»æ“ä½œç³»ç»Ÿå–å¾—å†…å­˜ç”¨äºå­˜å‚¨<code>å¯¹è±¡</code></p>

<pre><code class="language-objc">Car *car = [[Car alloc] init ];
</code></pre>

<p>è€ŒåµŒå¥—è°ƒç”¨çš„åŸå› æ˜¯<code>ç±»ç°‡</code>é—®é¢˜, NSString å’Œ NSArray ç­‰ç±»çŸ¥è¯†ä¸€äº›ç‰¹æ®Šç±»çš„è¡¨è±¡, init æ–¹æ³•å¯ä»¥æ¥æ”¶å‚æ•°,å¹¶æ£€æŸ¥å…¶æ¥æ”¶çš„å‚æ•°,å¹¶å†³å®šè¿”å›å¦ä¸€ä¸ªç±»çš„å¯¹è±¡æ›´åˆé€‚.</p>

<h3 id="toc_2">åˆå§‹åŒ–æ–¹æ³•</h3>

<pre><code>(id) init
{
    if(self = [super init ])
    ...
}
</code></pre>

<p>è¿™ä¹ˆåˆå§‹åŒ–çš„ä½œç”¨æ˜¯è®©è¶…ç±»å®Œæˆå…¶è‡ªèº«çš„åˆå§‹åŒ–å·¥ä½œ. å¯¹äºç»§æ‰¿äº† NSobject çš„ç±»æ¥è¯´,è°ƒç”¨è¶…ç±»çš„ init æ–¹æ³•å¯ä»¥è®© NSObject æ‰§è¡Œå®ƒæ‰€éœ€è¦çš„æ‰€æœ‰æ“ä½œ,ä»¥ä¾¿å¯¹è±¡èƒ½<code>å“åº”ä¿¡æ¯å¹¶å¤„ç†ä¿ç•™è®¡æ•°å™¨</code>,è€Œä»å¯¹äºä»å…¶ä»–ç±»ç»§æ‰¿çš„ç±»,é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å®ç°è‡ªèº«çš„å…¨æ–°åˆå§‹åŒ–.</p>

<p>åœ¨å†…å­˜ç®¡ç†ä¸­, self æŒ‡é’ˆé€šè¿‡å¯¹è±¡åŸºå€çš„åç§»å»æ“ä½œä¸€ä¸ªå¯¹è±¡, ä»£ç ä¸­çš„<code>self =</code> å°±æ˜¯æ›´æ–° self æŒ‡é’ˆ,å°†å…¶æŒ‡å‘å…¶è¶…ç±»åˆå§‹åŒ–åçš„å†…å­˜.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[è¯‘] Sequelize(2)  å®šä¹‰è¡¨æ ¼]]></title>
    <link href="http://kayorl.com/14872314142360.html"/>
    <updated>2017-02-16T15:50:14+08:00</updated>
    <id>http://kayorl.com/14872314142360.html</id>
    <content type="html"><![CDATA[
<p>Sequelize ä¼šè‡ªåŠ¨å¢åŠ  <code>createdAt</code> å’Œ <code>updated</code> å±æ€§,è¿™æ ·èƒ½çŸ¥é“ä¸€ä¸ªå®ä¾‹çš„åˆ›å»ºæ—¶é—´å’Œæœ€ç»ˆä¿®æ”¹æ—¶é—´.</p>

<p>å¦‚æœä¸æƒ³è‡ªåŠ¨ç”Ÿæˆ,å¯ä»¥åˆ°<a href="http://docs.sequelizejs.com/en/v3/docs/models-definition/#configuration">configuration</a>å»çœ‹å¦‚ä½•å®ç°.</p>

<span id="more"></span><!-- more -->

<blockquote>
<p>å®šä¹‰æ¨¡å‹ä¸è¡¨ä¹‹é—´çš„æ˜ å°„,ä½¿ç”¨ define æ–¹æ³•. </p>
</blockquote>

<pre><code class="language-js">var Project = sequelize.define(&#39;project&#39;, {
  title: Sequelize.STRING,
  description: Sequelize.TEXT
})

var Task = sequelize.define(&#39;task&#39;, {
  title: Sequelize.STRING,
  description: Sequelize.TEXT,
  deadline: Sequelize.DATE
})
</code></pre>

<p>è¿˜å¯ä»¥ä¸ºæ¯ä¸€ä¸ªåˆ—å¢åŠ ä¸€äº›å¯é€‰å±æ€§</p>

<pre><code class="language-js">var Foo = sequelize.define(&#39;foo&#39;, {
 // è‡ªåŠ¨è®¾ç½®é»˜è®¤å€¼ä¸º true
 flag: { type: Sequelize.BOOLEAN, allowNull: false, defaultValue: true},

 //  æ—¥æœŸé»˜è®¤å€¼ =&gt; å½“å‰æ—¶é—´
 myDate: { type: Sequelize.DATE, defaultValue: Sequelize.NOW },

 // è®¾ç½®åˆ—çš„ allowNullä¸º false å°†ä¼šä¸ºè¯¥åˆ—å¢åŠ  éç©º å±æ€§
 // åœ¨æŸ¥è¯¢æ•°æ®åº“ä¹‹å‰æƒ³æ£€è½¦ä¸€ä¸ªå€¼æ˜¯å¦ä¸º ç©º ,çœ‹ validation èŠ‚
 title: { type: Sequelize.STRING, allowNull: false},
 
 // åˆ›å»ºä¸¤ä¸ªæ‹¥æœ‰ç›¸åŒå±æ€§çš„å€¼ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯
 // The unique property can be either a boolean, or a string.
 // If you provide the same string for multiple columns, they will form a
 // composite unique key.
 someUnique: {type: Sequelize.STRING, unique: true},
 uniqueOne: { type: Sequelize.STRING,  unique: &#39;compositeIndex&#39;},
 uniqueTwo: { type: Sequelize.INTEGER, unique: &#39;compositeIndex&#39;}
 
 // unique å±æ€§åŒæ—¶ä¹Ÿæ˜¯åˆ›å»ºä¸€ä¸ª unique ç´¢å¼• çš„ç®€å†™
 someUnique: {type: Sequelize.STRING, unique: true}
 
 // è·Ÿä¸‹é¢çš„ä¸¤å¥å®šä¹‰è¯­å¥ç­‰ä»·
 {someUnique: {type: Sequelize.STRING}},
 {indexes: [{unique: true, fields: [&#39;someUnique&#39;]}]}

 // ä¸»ç 
 identifier: { type: Sequelize.STRING, primaryKey: true},
 
 // è‡ªå¢
 incrementMe: { type: Sequelize.INTEGER, autoIncrement: true },

 // æ³¨é‡Š,åªæœ‰ MySQL å’Œ PG å¯ä»¥ä½¿ç”¨
 // Comments can be specified for each field for MySQL and PG
 hasComment: { type: Sequelize.INTEGER, comment: &quot;I&#39;m a comment!&quot; },
 
 // åœ¨æ¨¡å‹ä¸­çš„åå­—æ˜¯å°é©¼å³°,åœ¨è¡¨ä¸­çš„åˆ—åå¯ä»¥ç”¨ field å±æ€§æ¥æŒ‡å®š
 fieldWithUnderscores: { type: Sequelize.STRING, field: &quot;field_with_underscores&quot; },

 // åˆ›å»ºå¤–ç 
 bar_id: {
   type: Sequelize.INTEGER,

   references: {
     // This is a reference to another model
     model: Bar,
     //è¢«å¼•ç”¨æ¨¡å‹çš„  åˆ—å  (æ˜¯åˆ—å,å³ field å)
     key: &#39;id&#39;,
     // æ£€æŸ¥å¤–ç çº¦æŸ,åªæ”¯æŒ PostgreSQL .
     deferrable: Sequelize.Deferrable.INITIALLY_IMMEDIATE
   }
 }
})
</code></pre>

<h2 id="toc_0">æ•°æ®ç±»å‹</h2>

<p>æ›´è¯¦ç»†çš„å¯ä»¥ä¸Š <a href="http://docs.sequelizejs.com/en/v3/api/datatypes">DataTypes</a> çœ‹ä¸€çœ‹</p>

<pre><code class="language-js">Sequelize.STRING                      // VARCHAR(255)
Sequelize.STRING(1234)                // VARCHAR(1234)
Sequelize.STRING.BINARY               // VARCHAR BINARY
Sequelize.TEXT                        // TEXT
Sequelize.TEXT(&#39;tiny&#39;)                // TINYTEXT

Sequelize.INTEGER                     // INTEGER
Sequelize.BIGINT                      // BIGINT
Sequelize.BIGINT(11)                  // BIGINT(11)

Sequelize.FLOAT                       // FLOAT
Sequelize.FLOAT(11)                   // FLOAT(11)
Sequelize.FLOAT(11, 12)               // FLOAT(11,12)

Sequelize.REAL                        // REAL        PostgreSQL only.
Sequelize.REAL(11)                    // REAL(11)    PostgreSQL only.
Sequelize.REAL(11, 12)                // REAL(11,12) PostgreSQL only.

Sequelize.DOUBLE                      // DOUBLE
Sequelize.DOUBLE(11)                  // DOUBLE(11)
Sequelize.DOUBLE(11, 12)              // DOUBLE(11,12)

Sequelize.DECIMAL                     // DECIMAL
Sequelize.DECIMAL(10, 2)              // DECIMAL(10,2)

Sequelize.DATE                        // DATETIME for mysql / sqlite, TIMESTAMP WITH TIME ZONE for postgres
Sequelize.DATE(6)                     // DATETIME(6) for mysql 5.6.4+. Fractional seconds support with up to 6 digits of precision 
Sequelize.DATEONLY                    // DATE without time.
Sequelize.BOOLEAN                     // TINYINT(1)

Sequelize.ENUM(&#39;value 1&#39;, &#39;value 2&#39;)  // An ENUM with allowed values &#39;value 1&#39; and &#39;value 2&#39;
Sequelize.ARRAY(Sequelize.TEXT)       // Defines an array. PostgreSQL only.

Sequelize.JSON                        // JSON column. PostgreSQL only.
Sequelize.JSONB                       // JSONB column. PostgreSQL only.

Sequelize.BLOB                        // BLOB (bytea for PostgreSQL)
Sequelize.BLOB(&#39;tiny&#39;)                // TINYBLOB (bytea for PostgreSQL. Other options are medium and long)

Sequelize.UUID                        // UUID datatype for PostgreSQL and SQLite, CHAR(36) BINARY for MySQL (use defaultValue: Sequelize.UUIDV1 or Sequelize.UUIDV4 to make sequelize generate the ids automatically)


Sequelize.GEOMETRY                    // Spatial column.  PostgreSQL (with PostGIS) or MySQL only.
Sequelize.GEOMETRY(&#39;POINT&#39;)           // Spatial column with geomerty type.  PostgreSQL (with PostGIS) or MySQL only.
Sequelize.GEOMETRY(&#39;POINT&#39;, 4326)     // Spatial column with geomerty type and SRID.  PostgreSQL (with PostGIS) or MySQL only.
</code></pre>

<p>integer, bigint, float å’Œ double åŒæ ·æ”¯æŒ unsigned å’Œ zerofill çº¦æŸ   </p>

<pre><code class="language-js">Sequelize.INTEGER.UNSIGNED              // INTEGER UNSIGNED
Sequelize.INTEGER(11).UNSIGNED          // INTEGER(11) UNSIGNED
Sequelize.INTEGER(11).ZEROFILL          // INTEGER(11) ZEROFILL
Sequelize.INTEGER(11).ZEROFILL.UNSIGNED // INTEGER(11) UNSIGNED ZEROFILL
Sequelize.INTEGER(11).UNSIGNED.ZEROFILL // INTEGER(11) UNSIGNED ZEROFILL
</code></pre>

<h3 id="toc_1">å¯¹è±¡æ ‡è®°çš„ç”¨æ³•</h3>

<pre><code class="language-js">// for enums:
sequelize.define(&#39;model&#39;, {
  states: {
    type:   Sequelize.ENUM,
    values: [&#39;active&#39;, &#39;pending&#39;, &#39;deleted&#39;]
  }
})
</code></pre>

<hr/>

<h2 id="toc_2">Getters &amp; Setters æ–¹æ³•</h2>

<p>åœ¨æ¨¡å‹ä¸­å®šä¹‰&#39;å¯¹è±¡-å±æ€§&#39;çš„ getter å’Œ  setter æ–¹æ³•æ˜¯å¯èƒ½çš„,å¯ä»¥è¢«ç”¨æ¥ä¿æŠ¤ä¸æ•°æ®åº“åˆ—ç›¸æ˜ å°„çš„å±æ€§,è¿˜å¯ä»¥å®šä¹‰ä¸€äº›<code>å‡</code>å±æ€§<br/>
Getters å’Œ Setters èƒ½ä»¥ä¸‹é¢ä¸¤ç§æ–¹å¼å®šä¹‰</p>

<ul>
<li>ä½œä¸ºå•ä¸ªå±æ€§å®šä¹‰çš„ä¸€éƒ¨åˆ†</li>
<li>ä½œä¸ºæ¨¡å‹å¯é€‰çš„ä¸€éƒ¨åˆ†</li>
</ul>

<h2 id="toc_3">å®šä¹‰ä¸ºå±æ€§çš„ä¸€éƒ¨åˆ†</h2>

<pre><code class="language-js">var Employee = sequelize.define(&#39;employee&#39;, {
  name:  {
    type     : Sequelize.STRING,
    allowNull: false,
    get      : function()  {
      var title = this.getDataValue(&#39;title&#39;);
      // &#39;this&#39; å…è®¸ä½ å»è·å¾—å®ä¾‹çš„å±æ€§
      return this.getDataValue(&#39;name&#39;) + &#39; (&#39; + title + &#39;)&#39;;
    },
  },
  title: {
    type     : Sequelize.STRING,
    allowNull: false,
    set      : function(val) {
      this.setDataValue(&#39;title&#39;, val.toUpperCase());
    }
  }
});

Employee
  .create({ name: &#39;John Doe&#39;, title: &#39;senior engineer&#39; })
  .then(function(employee) {
    console.log(employee.get(&#39;name&#39;)); // John Doe (SENIOR ENGINEER)
    console.log(employee.get(&#39;title&#39;)); // SENIOR ENGINEER
  })
</code></pre>

<h4 id="toc_4">å®šä¹‰ä¸ºæ¨¡å‹çš„ä¸€éƒ¨åˆ†</h4>

<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨æ¨¡å‹å†…å®šä¹‰ getter å’Œ setter æ–¹æ³•çš„ä¾‹å­. åœ¨è¿™ä¸ªä¾‹å­é‡Œ,<code>fullname</code> çš„ getter æ–¹æ³•æ˜¯åœ¨æ¨¡å‹å†…å®šä¹‰<code>å‡å±æ€§</code>çš„ä¸€ä¸ªä¾‹å­<br/>
,å› ä¸º <code>fullname</code>  å±æ€§ä¸å­˜åœ¨äºæ•°æ®åº“æ¨¡å¼ä¸­. å®é™…ä¸Š,å‡å±æ€§å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ¥å®šä¹‰</p>

<ul>
<li>é€šè¿‡æ¨¡å‹çš„ getter æ–¹æ³•</li>
<li>æˆ–è€…é€šè¿‡ä½¿ç”¨å¸¦æœ‰ <a href="http://docs.sequelizejs.com/en/v3/api/datatypes#virtual"><code>VIRTUAL</code></a> æ•°æ®ç±»å‹çš„åˆ—, VIRTUAL æ•°æ®ç±»å‹å¯ä»¥æœ‰ validation , ç„¶è€Œ virtual æ•°æ®ç±»å‹çš„ getter æ–¹æ³•ä¸è¡Œ</li>
</ul>

<p>æ³¨æ„åœ¨ <code>fullName</code> çš„ getter æ–¹æ³•ä¸­å¼•ç”¨çš„ <code>this.firstName</code> å’Œ <code>this.lastName</code> ä¼šè§¦å‘å„è‡ªçš„ getter æ–¹æ³•</p>

<pre><code class="language-js">var Foo = sequelize.define(&#39;foo&#39;, {
  firstname: Sequelize.STRING,
  lastname: Sequelize.STRING
}, {
  getterMethods   : {
    fullName       : function()  { return this.firstname + &#39; &#39; + this.lastname }
  },
  
  setterMethods   : {
    fullName       : function(value) {
        var names = value.split(&#39; &#39;);
        this.setDataValue(&#39;firstname&#39;, names.slice(0, -1).join(&#39; &#39;));
        this.setDataValue(&#39;lastname&#39;, names.slice(-1).join(&#39; &#39;));
    },
  }
});

</code></pre>

<h4 id="toc_5">åœ¨ getter å’Œ setter æ–¹æ³•ä¸­ä½¿ç”¨çš„ Helper æ–¹æ³•</h4>

<ul>
<li>è·å–ä¸€ä¸ªåŸºç¡€å±æ€§å€¼ , ç»å¸¸ç”¨ <code>this.getDataValue()</code></li>
<li>è®¾ç½®ä¸€ä¸ªåŸºç¡€å±æ€§å€¼ , ç»å¸¸ç”¨ <code>this.setDataValue()</code></li>
<li>åšæŒä½¿ç”¨ getter å’Œ setter æ–¹æ³• å¯ä»¥ä¿æŠ¤å†…éƒ¨æ•°æ®</li>
</ul>

<pre><code class="language-js">/* &#39;title&#39; å±æ€§çš„ getter æ–¹æ³•*/
function(){
    return this.getDataValue(&#39;title&#39;);
}

/* &#39;title&#39; å±æ€§çš„ setter æ–¹æ³•*/
function(){
    return this.setDataValue(&#39;title&#39;,title.toString().toLowerCase());
}
</code></pre>

<h2 id="toc_6">è®¤è¯ (Validation)</h2>

<p>æ¨¡å‹è®¤è¯, å¯ä»¥è§„å®šæ¨¡å‹ä¸­æ¯ä¸ªå±æ€§çš„æ ¼å¼/å†…å®¹ çš„è®¤è¯. å…¶å®ç°åœ¨<a href="https://github.com/chriso/validator.js">è¿™</a></p>

<p>å½“è¿›è¡Œ <code>create</code>,<code>update</code> å’Œ <code>save</code>æ“ä½œæ—¶,è®¤è¯ä¼šè‡ªåŠ¨è¿è¡Œ.ä¹Ÿå¯ä»¥åœ¨å®ä¾‹ä¸­æ‰‹åŠ¨è®¤è¯</p>

<pre><code class="language-js">var ValidateMe = sequelize.define(&#39;foo&#39;, {
  foo: {
    type: Sequelize.STRING,
    validate: {
      is: [&quot;^[a-z]+$&quot;,&#39;i&#39;],     // will only allow letters
      is: /^[a-z]+$/i,          // same as the previous example using real RegExp
      not: [&quot;[a-z]&quot;,&#39;i&#39;],       // will not allow letters
      isEmail: true,            // checks for email format (foo@bar.com)
      isUrl: true,              // checks for url format (http://foo.com)
      isIP: true,               // checks for IPv4 (129.89.23.1) or IPv6 format
      isIPv4: true,             // checks for IPv4 (129.89.23.1)
      isIPv6: true,             // checks for IPv6 format
      isAlpha: true,            // will only allow letters
      isAlphanumeric: true,     // will only allow alphanumeric characters, so &quot;_abc&quot; will fail
      isNumeric: true,          // will only allow numbers
      isInt: true,              // checks for valid integers
      isFloat: true,            // checks for valid floating point numbers
      isDecimal: true,          // checks for any numbers
      isLowercase: true,        // checks for lowercase
      isUppercase: true,        // checks for uppercase
      notNull: true,            // won&#39;t allow null
      isNull: true,             // only allows null
      notEmpty: true,           // don&#39;t allow empty strings
      equals: &#39;specific value&#39;, // only allow a specific value
      contains: &#39;foo&#39;,          // force specific substrings
      notIn: [[&#39;foo&#39;, &#39;bar&#39;]],  // check the value is not one of these
      isIn: [[&#39;foo&#39;, &#39;bar&#39;]],   // check the value is one of these
      notContains: &#39;bar&#39;,       // don&#39;t allow specific substrings
      len: [2,10],              // only allow values with length between 2 and 10
      isUUID: 4,                // only allow uuids
      isDate: true,             // only allow date strings
      isAfter: &quot;2011-11-05&quot;,    // only allow date strings after a specific date
      isBefore: &quot;2011-11-05&quot;,   // only allow date strings before a specific date
      max: 23,                  // only allow values
      min: 23,                  // only allow values &gt;= 23
      isArray: true,            // only allow arrays
      isCreditCard: true,       // check for valid credit card numbers

      // custom validations are also possible:
      isEven: function(value) {
        if(parseInt(value) % 2 != 0) {
          throw new Error(&#39;Only even values are allowed!&#39;)
        // we also are in the model&#39;s context here, so this.otherField
        // would get the value of otherField if it existed
        }
      }
    }
  }
});
</code></pre>

<p>æ³¨æ„å½“å¤šä¸ªå‚æ•°éœ€è¦è¢«ä¼ é€’åˆ°å†…åµŒçš„è®¤è¯å‡½æ•°æ—¶,å¤šä¸ªå‚æ•°åº”è¯¥è¢«æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­.</p>

<pre><code class="language-js">isIn: [[&#39;en&#39;, &#39;zh&#39;]],   // check the value is one of these
</code></pre>

<p>ä¸ç”¨ validator.js æä¾›çš„é”™è¯¯ä¿¡æ¯,è‡ªå·±å®šåˆ¶é”™è¯¯ä¿¡æ¯</p>

<pre><code class="language-js">isIn: {
  args: [[&#39;en&#39;, &#39;zh&#39;]],
  msg: &quot;Must be English or Chinese&quot;
}
</code></pre>

<p>å¯ä»¥çœ‹<a href="https://github.com/chriso/validator.js">validator.js PROJECT</a>è·å–æ›´å¤šç»†èŠ‚</p>

<hr/>

<h3 id="toc_7">è®¤è¯å™¨å’Œ <code>allowNull</code></h3>

<p>å¦‚æœæ¨¡å‹çš„åˆ—è¢«è®¾ç½®ä¸º <code>allowNull:true</code> å’Œ å€¼è¢«è®¾ç½®ä¸º <code>null</code>çš„è¯,é‚£è®¤è¯å™¨ä¸ä¼šè¿è¡Œ.</p>

<p>ä¸¾ä¸ªæ —å­, ä¸€ä¸ªå­—ç¬¦ä¸²çš„åˆ—é•¿åº¦è®¾ç½®ä¸º æœ€çŸ­ä¸º5, ä½†å®ƒå¯ä»¥å­˜å‚¨ null</p>

<h3 id="toc_8">æ¨¡å‹è®¤è¯</h3>

<pre><code class="language-js">var Pub = Sequelize.define(&#39;pub&#39;, {
  name: { type: Sequelize.STRING },
  address: { type: Sequelize.STRING },
  latitude: {
    type: Sequelize.INTEGER,
    allowNull: true,
    defaultValue: null,
    validate: { min: -90, max: 90 }
  },
  longitude: {
    type: Sequelize.INTEGER,
    allowNull: true,
    defaultValue: null,
    validate: { min: -180, max: 180 }
  },
}, {


  //åœ¨è¿™é‡Œå¯¹æ¨¡å‹è¿›è¡ŒéªŒè¯,åªæœ‰ latitude å’Œ longtitude åŒæ—¶è¢«ç»™äºˆæˆ–éƒ½ä¸ºç©ºæ—¶æˆç«‹
  validate: {
    bothCoordsOrNone: function() {
      if ((this.latitude === null) !== (this.longitude === null)) {
        throw new Error(&#39;Require either both latitude and longitude or neither&#39;)
      }
    }
  }
})
</code></pre>

<hr/>

<h2 id="toc_9">é…ç½®</h2>

<pre><code class="language-js">var Bar = sequelize.define(&#39;bar&#39;, { /* bla */ }, {

  // ä¸å¢åŠ  TIMESTAMP å±æ€§  (updatedAt, createdAt)
  timestamps: false,
  
  //ä¸åˆ é™¤æ•°æ®åº“ä¸­åŸæœ‰é¡¹, å¢åŠ æ–°å±æ€§ deletedAt å¹¶è®¾ç½®ä¸º å½“å‰æ—¥æœŸ,
  //åªæœ‰ TIMESTAMP å±æ€§æ˜¯å…è®¸çš„æ—¶å€™æœ‰æ•ˆ
  paranoid: true,
  
  // ä¸è¦ä½¿ç”¨é©¼å³°å¼è¯­æ³•,ç”¨ä¸‹åˆ’çº¿ä»£æ›¿
  // so updatedAt will be updated_at
  underscored: true,
  
  // ä¸å…è®¸è°ƒæ•´è¡¨å ; 
  // é»˜è®¤åœ°, sequelize ä¼šè‡ªåŠ¨è½¬æ¢æ‰€æœ‰ä¼ é€’çš„æ¨¡å‹åå­—(define çš„ç¬¬ä¸€ä¸ªå‚æ•°)
  // ä¸ºå¤æ•°
  // å¦‚æœä¸æƒ³è¿™æ ·,è®¾ç½®ä¸º true
  freezeTableName: true,

  // å®šä¹‰è¡¨å
  tableName: &#39;my_very_custom_table_name&#39;
})
</code></pre>

<p>ä¿®æ”¹å¼•æ“</p>

<pre><code class="language-js">var Person = sequelize.define(&#39;person&#39;, { /* attributes */ }, {
  engine: &#39;MYISAM&#39;
})

// or globally
var sequelize = new Sequelize(db, user, pw, {
  define: { engine: &#39;MYISAM&#39; }
})
</code></pre>

<p>åšæ³¨é‡Š</p>

<pre><code class="language-js">var Person = sequelize.define(&#39;person&#39;, { /* attributes */ }, {
  comment: &quot;I&#39;m a table comment!&quot;
})
</code></pre>

<hr/>

<h2 id="toc_10">å¯¼å…¥</h2>

<p>å¯ä»¥æŠŠå¯¹è¡¨çš„å®šä¹‰æ”¾åœ¨å•ä¸€æ–‡ä»¶ä¸­,è¿”å›å¯¹è±¡æ°å¥½è·Ÿåœ¨ import æ–¹æ³•ä¸­å®šä¹‰çš„ä¸€æ ·</p>

<pre><code class="language-js">
  // in your server file - e.g. app.js
var Project = sequelize.import(__dirname + &quot;/path/to/models/project&quot;)

  // å®šä¹‰åœ¨ project.js æ–‡ä»¶ä¸­å·²ç»å®šä¹‰å®Œæˆäº†
  // DataTypes  ä¸ä¸Šé¢è§£é‡Šçš„éƒ¨åˆ†å¾ˆåƒ
module.exports = function(sequelize, DataTypes) {
  return sequelize.define(&quot;project&quot;, {
    name: DataTypes.STRING,
    description: DataTypes.TEXT
  })
}

sequelize.import(&#39;project&#39;, function(sequelize, DataTypes) {
  return sequelize.define(&quot;project&quot;, {
    name: DataTypes.STRING,
    description: DataTypes.TEXT
  })
})
</code></pre>

<h2 id="toc_11">æ•°æ®åº“åŒæ­¥</h2>

<p>å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®çš„æ—¶å€™,æˆ‘ä»¬æ²¡æœ‰æ•°æ®åº“æ¶æ„,äºæ˜¯æˆ‘ä»¬ä¸éœ€è¦ Sequelize.</p>

<p>åªéœ€è¦è¯´æ˜æˆ‘ä»¬çš„æ¨¡å‹ç»“æ„, è®©åº“åšå‰©ä¸‹çš„éƒ¨åˆ†,ç°åœ¨åªæ”¯æŒ <code>è¡¨çš„åˆ›å»ºä¸åˆ é™¤</code></p>

<pre><code class="language-js">// åªåŒæ­¥è¿˜æ²¡åœ¨æ•°æ®åº“ä¸­çš„æ¨¡å‹
// Sync all models that aren&#39;t already in the database
sequelize.sync()

// å¼ºåˆ¶åŒæ­¥æ‰€æœ‰æ•°æ®åº“çš„æ¨¡å‹
sequelize.sync({force: true})

// åˆ é™¤æ‰€æœ‰è¡¨
sequelize.drop()

// å¼€å§‹æ‰§è¡Œ
sequelize.[sync|drop]().then(function() {
  // woot woot
}).catch(function(error) {
  // whooops
})
</code></pre>

<p>å› ä¸º<code>.sync({force: true})</code> æ˜¯æ¯ç­æ€§çš„æ“ä½œ, å¯ä»¥ä½¿ç”¨ match é€‰é¡¹å»å¢åŠ æ›´å¤šçš„å®‰å…¨æ£€æŸ¥(æ­£åˆ™)</p>

<pre><code class="language-js">// åˆ é™¤ä»¥ &#39;_test&#39; ç»“å°¾çš„è¯
sequelize.sync({ force: true, match: /_test$/ });
</code></pre>

<hr/>

<h2 id="toc_12">æ¨¡å‹çš„æ‰©å±•</h2>

<p>Sequelize å…è®¸æˆ‘ä»¬å»ç»™ æ¨¡å‹å’Œç›¸åº”çš„å®ä¾‹ ä¼ é€’å®šåˆ¶æ–¹æ³• </p>

<pre><code class="language-js">var sequelize = new Sequelize(&#39;database&#39;, &#39;username&#39;, &#39;password&#39;, {
  // å…¶ä»–å¯é€‰çš„åˆå§‹åŒ–å¯ä»¥æ”¾åœ¨è¿™é‡Œ
  define: {
    classMethods: {
      method1: function() {},
      method2: function() {}
    },
    instanceMethods: {
      method3: function() {}
    }
  }
})

// Example:
var Foo = sequelize.define(&#39;foo&#39;, { /* attributes */});
Foo.method1()
Foo.method2()
Foo.build().method3()
</code></pre>

<hr/>

<h2 id="toc_13">ç´¢å¼•</h2>

<p>Sequelize æ”¯æŒåœ¨æ¨¡å‹å®šä¹‰ä¸­å¢åŠ ç´¢å¼•, è¿™äº›ç´¢å¼•åœ¨ <code>Model.sync()</code> æˆ– <code>sequelize.sync()</code>æ—¶è¢«åˆ›å»º.</p>

<pre><code class="language-js">sequelize.define(&#39;user&#39;, {}, {
  indexes: [
    // Create a unique index on email
    {
      unique: true,
      fields: [&#39;email&#39;]
    },

    // Creates a gin index on data with the jsonb_path_ops operator
    {
      fields: [&#39;data&#39;],
      using: &#39;gin&#39;,
      operator: &#39;jsonb_path_ops&#39;
    },

    // By default index name will be [table]_[fields]
    // Creates a multi column partial index
    {
      name: &#39;public_by_author&#39;,
      fields: [&#39;author&#39;, &#39;status&#39;],
      where: {
        status: &#39;public&#39;
      }
    },

    // A BTREE index with a ordered field
    {
      name: &#39;title_index&#39;,
      method: &#39;BTREE&#39;,
      fields: [&#39;author&#39;, {attribute: &#39;title&#39;, collate: &#39;en_US&#39;, order: &#39;DESC&#39;, length: 5}]
    }
  ]
})
</code></pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(7) å¼‚å¸¸]]></title>
    <link href="http://kayorl.com/14872504904064.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504904064.html</id>
    <content type="html"><![CDATA[
<p>åœ¨è¿è¡Œæ—¶ç³»ç»Ÿä¸­åˆ›å»ºå¹¶å¤„ç†å¼‚å¸¸çš„è¡Œä¸ºæˆä¸º<code>æŠ›å‡ºå¼‚å¸¸</code></p>

<span id="more"></span><!-- more -->

<ul>
<li>@try : å†³å®šæ˜¯å¦æŠ›å‡ºå¼‚å¸¸</li>
<li>@catch() : æ¥æ”¶å‚æ•°,é€šå¸¸æ˜¯ NSException ,æœ€å¥½æ˜¯ NSException</li>
<li>@finally : æ— è®ºå¦‚ä½•éƒ½æ‰§è¡Œçš„ä»£ç </li>
<li>@throw : æŠ›å‡ºå¼‚å¸¸</li>
<li>@tryå»ºç«‹å¼‚å¸¸ä¸ä¼šäº§ç”Ÿæ¶ˆè€—</li>
<li>æ•æ‰å¼‚å¸¸ä¼šæ¶ˆè€—å¤§é‡èµ„æº</li>
</ul>

<pre><code>@try{

    //code might throw an exception

}@catch(NSException *exception)
{   

    @throw exception    //æˆ–è€…[exception raise],è¿™ç§æ–¹æ³•åªå¯¹ NSException æœ‰æ•ˆ
    
    
}@catch(MyException *custom){

    //code to handles exception

}@finally
{

    //code always be excuted. Typically for cleanup.

}
</code></pre>

<h2 id="toc_0">å¼‚å¸¸çš„å†…å­˜ç®¡ç†</h2>

<ul>
<li>ç”¨@finally å»æ”¶æ‹¾æ®‹å±€</li>
<li>@catch ä»£ç å—ä¼šå†æ¬¡æŠ›å‡ºå¼‚å¸¸, @finally åœ¨å¼‚å¸¸é‡æ–°æŠ›å‡ºä¹‹å‰æ‰§è¡Œä»£ç ,è¯ç”Ÿåƒµå°¸å¼‚å¸¸( zombie exception)</li>
<li>ä¸Šé¢çš„è§£å†³æ–¹æ³•æ˜¯: åœ¨è‡ªåŠ¨å›æ”¶æ± ä¹‹å¤–ä¿ç•™å¼‚å¸¸[saveException retain]]å°±å¯ä»¥äº†, è®°å¾—åœ¨@finally é‡Œ,è‡ªåŠ¨å›æ”¶æ± ä¹‹åæé†’è‡ªåŠ¨é‡Šæ”¾</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(6) å†…å­˜æ§åˆ¶-ç®¡ç†è§„åˆ™]]></title>
    <link href="http://kayorl.com/14872504903926.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504903926.html</id>
    <content type="html"><![CDATA[
<p>å½“ä½¿ç”¨äº† new, alloc æˆ– copy æ–¹æ³•è·å¾—å¯¹è±¡, å°±é‡Šæ”¾æˆ–è€…è‡ªåŠ¨é‡Šæ”¾è¯¥å¯¹è±¡</p>

<span id="more"></span><!-- more -->

<h2 id="toc_0">ä¸´æ—¶å¯¹è±¡</h2>

<pre><code>
NSMutableArray *array;
array= [[NSMutableArray alloc] init];   //alloc, éœ€è¦é‡Šæ”¾
[array release];

NSMutableArray *array2;
array2= [NSMutableArray arrayWithCapacity : 18]; //é new, alloc æˆ– copy , è‡ªåŠ¨é‡Šæ”¾
</code></pre>

<h2 id="toc_1">æ‹¥æœ‰å¯¹è±¡</h2>

<p>å¸Œæœ›åœ¨å¤šæ®µä»£ç ä¸­ä¸€ç›´æ‹¥æœ‰æŸä¸ªå¯¹è±¡<br/>
* æŠŠå®ƒä»¬åŠ å…¥åˆ° NSArray æˆ– NSDictionary ç­‰é›†åˆä¸­, ä½œä¸ºå…¶ä»–å¯¹è±¡çš„å®ä¾‹å˜é‡æ¥ä½¿ç”¨<br/>
* ä½¿ç”¨ new, alloc æˆ– copy æ–¹æ³•è·å¾—äº†å¯¹è±¡, å®ƒå°†ä¸€ç›´å­˜åœ¨,éœ€è¦åœ¨<code>æ‹¥æœ‰è¯¥å¯¹è±¡çš„ dealloc æ–¹æ³•ä¸­é‡Šæ”¾å®ƒ</code><br/>
* ?ç¼–å†™ GUI åº”ç”¨ç¨‹åºæ—¶,éœ€è¦ä¿ç•™è‡ªåŠ¨é‡Šæ”¾çš„å¯¹è±¡( [object retain]),ä»¥ä¾¿åœ¨å¾ªç¯åä»ç„¶èƒ½å­˜åœ¨<br/>
* è‡ªåŠ¨é‡Šæ”¾æ± çš„æ¸…ç†æ—¶é—´æ˜¯å®Œå…¨ç¡®å®šçš„<br/>
* å¤§é‡çš„<code>è¿­ä»£</code>æ¯æ¬¡å›ç”Ÿæˆä¸€ä¸ªè‡ªåŠ¨é‡Šæ”¾å¯¹è±¡,åªæœ‰æ–¹æ³•å®Œæˆæ—¶æ‰ä¼šè‡ªåŠ¨é‡Šæ”¾,è§£å†³æ–¹æ³•æ˜¯åˆ›å»ºè‡ªå·±çš„è‡ªåŠ¨é‡Šæ”¾æ± </p>

<h2 id="toc_2">åƒåœ¾å›æ”¶</h2>

<ul>
<li>åªæ”¯æŒ OS X åº”ç”¨ç¨‹åºå¼€å‘ , ä¸æ”¯æŒ iOS åº”ç”¨ç¨‹åº</li>
<li>OC2 ä¸­çš„åƒåœ¾å›æ”¶å™¨æ˜¯æ–°å‹çš„,æ–°åˆ›å»ºçš„å¯¹è±¡æ›´å¯èƒ½æ˜¯åƒåœ¾</li>
<li>å¦‚æœæ›¾åœ¨ä¸€ä¸ªå®ä¾‹å˜é‡ä¸­æŒ‡å‘å…¶ä»–å¯¹è±¡,ä¸ç”¨çš„æ—¶å€™ç½®ä¸º <code>nil</code>,è¿™æ ·åƒåœ¾å›æ”¶å™¨å¯ä»¥è¿›è¡Œæ¸…ç†</li>
<li>iOS å¼€å‘ä¸­,<code>ä¸è¦ä½¿ç”¨ autorelease æ–¹æ³•</code></li>
<li><code>ä¸è¦ä½¿ç”¨ä¼šè¿”å›è‡ªåŠ¨é‡Šæ”¾å¯¹è±¡çš„ä¾¿åˆ©æ–¹æ³•</code>, æ¯”å¦‚ NSString çš„æ‰€æœ‰ stringWith å¼€å¤´çš„æ–¹æ³•</li>
<li>è¿è¡Œæ—¶å·¥ä½œ</li>
</ul>

<hr/>

<h2 id="toc_3">è‡ªåŠ¨å¼•ç”¨è®¡æ•°(automatic reference counting , ARC)</h2>

<blockquote>
<p>åªéœ€è¦æŒ‰éœ€åˆ†é…å¹¶ä½¿ç”¨å¯¹è±¡,ç¼–è¯‘å™¨åœ¨<code>ç¼–è¯‘æ—¶</code>ä¼šå¸®ä½ æ’å…¥ retain å’Œ release è¯­å¥.</p>

<p>ä½†,å®ƒä¸è·Ÿåƒåœ¾å›æ”¶ä¸€èµ·ä½¿ç”¨</p>
</blockquote>

<p>ARC åªå¯¹å¯ä¿ç•™çš„å¯¹è±¡æŒ‡é’ˆ(Reatainable Object Pointers)æœ‰æ•ˆ,åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç§:</p>

<ol>
<li>ä»£ç å—æŒ‡é’ˆ</li>
<li>OC å¯¹è±¡æŒ‡é’ˆ</li>
<li>é€šè¿‡ <strong>attribute</strong>((NSObject)) ç±»å‹å®šä¹‰çš„æŒ‡é’ˆ</li>
</ol>

<p>ARC éœ€è¦æ³¨æ„çš„å‘½åè§„åˆ™</p>

<ul>
<li>å±æ€§åç§°ä¸èƒ½ä»¥ new å¼€å¤´,  @property NSString *newString æ˜¯ä¸å…è®¸çš„</li>
<li>å±æ€§ä¸èƒ½åªæœ‰ read-only è€Œæ²¡æœ‰ç®¡ç†ç‰¹æ€§,é»˜è®¤ç‰¹æ€§æ˜¯ assign</li>
</ul>

<h2 id="toc_4">å¼±å¼•ç”¨ (weak reference)</h2>

<blockquote>
<p>ä¸å¢åŠ ä¿ç•™è®¡æ•°å™¨çš„å€¼</p>
</blockquote>

<h4 id="toc_5">å†…å­˜æ³„éœ²ç‰ˆ</h4>

<ol>
<li>A -------&gt; B(2) -------&gt; C(1) ---------&gt; B(2)</li>
<li>A é‡Šæ”¾å¯¹ B çš„å¼•ç”¨</li>
<li>B(1) -------&gt; C(1) -------&gt; B(1)</li>
</ol>

<hr/>

<h4 id="toc_6">å¼±å¼•ç”¨ç‰ˆ</h4>

<p>ä½¿ç”¨ <code>assign</code> æ¥è·å–å¯¹è±¡ C æŒ‡å‘å¯¹è±¡ B çš„å¼•ç”¨.</p>

<ol>
<li>A -------&gt; B(1) -------&gt; C(1) - - - - -&gt; B(1)</li>
<li>A é‡Šæ”¾å¯¹ B çš„å¼•ç”¨ </li>
<li>B è¢«é‡Šæ”¾,åŒæ—¶é‡Šæ”¾å¯¹è±¡ C</li>
</ol>

<hr/>

<h4 id="toc_7">å¼±å¼•ç”¨é—®é¢˜ç‰ˆ</h4>

<ol>
<li>A -------&gt; B(1) &lt;- - - - - C</li>
<li>A é‡Šæ”¾å¯¹ B çš„å¼•ç”¨</li>
<li>B å·²ç»è¢«é‡Šæ”¾</li>
<li>C çš„å¼±å¼•ç”¨ä»ç„¶å­˜åœ¨</li>
</ol>

<h4 id="toc_8">å½’é›¶å¼±å¼•ç”¨(zero weak reference)</h4>

<blockquote>
<p>è®©å¯¹è±¡è‡ªå·±æ¸…ç©ºè‹¥å¼•ç”¨çš„å¯¹è±¡.</p>
</blockquote>

<p>åœ¨æŒ‡å‘çš„å¯¹è±¡é‡Šæ”¾å,å¼±å¼•ç”¨è¢«è®¾ç½®ä¸ºé›¶(nil)</p>

<p>å£°æ˜æ–¹å¼:</p>

<ol>
<li>__weak NSString *myString</li>
<li>@property(weak) NSString *myString</li>
</ol>

<hr/>

<h2 id="toc_9">æ‹¥æœ‰è€…æƒé™ (å¾…)</h2>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(4.1) Foundation Kit]]></title>
    <link href="http://kayorl.com/14872504903613.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504903613.html</id>
    <content type="html"><![CDATA[
<span id="more"></span><!-- more -->

<p>å­—é¢é‡è¯­æ³•:  </p>

<pre><code class="language-objc">NSString *str=@&quot;hello&quot;
</code></pre>

<h2 id="toc_0">å­—ç¬¦ä¸²</h2>

<h3 id="toc_1">NSString</h3>

<p>ä¸å¯å˜çš„æ•°ç»„</p>

<pre><code class="language-objc">#import &lt;Foundation/Foundation.h&gt;

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        NSString *some;
        NSString *other;
        some=[NSString stringWithFormat:@&quot;%s is useful , &quot;,&quot;Tool&quot;];
        other=@&quot;Kit&quot;;
        unsigned int size = 10;
        if ([some length] &gt; size) {
            NSLog(@&quot;%@ and it bigger than %d , \n&quot;,some,size);
        }
        if (![some isEqualToString:other]) {
            NSLog(@&quot;but it is different from %@.\n\n&quot;,other);
        }
    }
    
    
    NSString *small = @&quot;abc&quot;;
    NSString *small2 = small;
    NSString *big = @&quot;ABC&quot;;
    if ([small compare:small2] == NSOrderedSame) {
        NSLog(@&quot;%@ and %@ is the same.\n&quot;,small,small2);
    }
    
    
    /******** å¤§å†™å­—æ¯å°äºå°å†™å­—æ¯ ***********/
    if ([small compare:big] == NSOrderedAscending) {
        NSLog(@&quot;%@ is asc %@ .\n&quot;,small,big);
    }
    if ([small compare:big] == NSOrderedDescending) {
        NSLog(@&quot;%@ is des %@ .\n&quot;,small,big);
    }
    
    if ([small compare:big options:NSCaseInsensitiveSearch] == NSOrderedSame) {
        NSLog(@&quot;Case insencetive, then %@ is same as %@ .\n\n&quot;,small,big);
    }
    
    if ([small hasPrefix: @&quot;a&quot;]) {
        NSLog(@&quot;%@ has prefix:  %@&quot;,small,@&quot;a&quot;);
    }
    
    
    return 0;
}
</code></pre>

<p>è¾“å‡ºç»“æœ</p>

<pre><code>Tool is useful.  and the length of the saying bigger than 10 ,
but it is different from Kit.
abc and abc is the same.
abc des ABC
Case insencetive, then abc is same as ABC .
abc has prefix:  a
</code></pre>

<h3 id="toc_2">NSMutableString</h3>

<p>å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸², capacity åªæ˜¯å»ºè®®,ä¸é™åˆ¶å…¶å¤§å°</p>

<pre><code class="language-objc">#import &lt;Foundation/Foundation.h&gt;

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        NSMutableString *string = [NSMutableString stringWithCapacity:50];
        [string appendFormat:@&quot;I&#39;m %@&quot;,@&quot;kayor&quot;];
        [string appendString:@&quot;, yeah that&#39;s me.&quot;];
        NSLog(@&quot;%@&quot;,string);
        NSRange nameRange= [string rangeOfString:@&quot;kayor&quot;];
        [string replaceCharactersInRange:nameRange withString:@&quot;lien&quot;];
        NSLog(@&quot;%@&quot;,string);
    }
    return 0;
}

</code></pre>

<p>è¾“å‡ºç»“æœ</p>

<pre><code>I&#39;m kayor, yeah that&#39;s me.
I&#39;m lien, yeah that&#39;s me.
</code></pre>

<h2 id="toc_3">æ•°ç»„</h2>

<h3 id="toc_4">NSArray</h3>

<p>ä¸å¯å˜æ•°ç»„</p>

<pre><code class="language-objc">#import &lt;Foundation/Foundation.h&gt;

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        NSArray *array= [NSArray arrayWithObjects:@&quot;one&quot;, @&quot;two&quot;, @&quot;three&quot;,nil];
        unsigned long count= [array count];
        NSLog(@&quot;\n %@ \nwith count %lu \narray[1] : %@ \n&quot;,array,count,array[1]);
    }
    return 0;
}
</code></pre>

<p>è¾“å‡ºç»“æœ</p>

<pre><code class="language-objc"> (
    one,
    two,
    three
) 
with count 3 
array[1] : two 
</code></pre>

<h3 id="toc_5">NSMutableArray</h3>

<pre><code class="language-objc">NSMutableArray *array= [NSMutableArray arrayWithCapacity: 17];
</code></pre>

<ul>
<li>è‡ªåŠ¨å¡«è¡¥ç©ºç¼º</li>
</ul>

<h2 id="toc_6">æšä¸¾</h2>

<pre><code class="language-objc">NSEnumerator *enumerator =[array objectEnumerator];
while (id thingle = [enumerator nextObject])
{
  NSLog(@&quot;i get %@ \n&quot;,thingle);
}
</code></pre>

<ul>
<li>æ²¡æœ‰å¯ä»¥ç”¨æ¥åˆ›å»º NSMutableArray çš„å­—é¢é‡è¯­æ³•</li>
<li>ä¸èƒ½æ·»åŠ æˆ–åˆ é™¤å¯¹è±¡å»<code>æ”¹å˜å®¹é‡</code></li>
</ul>

<h3 id="toc_7">å¿«é€Ÿæšä¸¾</h3>

<pre><code class="language-objc">for(NSString *string in array)
{
    NSLog(@&quot;i get %@ \n&quot;,string);
}
</code></pre>

<h3 id="toc_8">ä»£ç å—æšä¸¾</h3>

<p>ä½¿ç”¨ä»£ç å—,å¯ä»¥å¾ªç¯å¹¶å‘æ‰§è¡Œ</p>

<pre><code class="language-objc">[array enumeratorObjectsUsingBlock:^(NSString *string,NSUInteger index, BOOL * stop){
    NSLog(@&quot;i get %@ \n&quot;,string);
}];
</code></pre>

<h2 id="toc_9">å­—å…¸</h2>

<p>å¯¹äºé¢‘ç¹çš„æŸ¥è¯¢å’Œå¤§å‹çš„æ•°æ®é›†è€Œè¨€,å­—å…¸æ¯”æ•°ç»„å¿«å¾ˆå¤š</p>

<h3 id="toc_10">NSDictionary</h3>

<ul>
<li>å­—é¢é‡è¯­æ³•åˆ›å»ºå¯¹è±¡</li>
<li><code>[dic objectForKey]</code>æ–¹æ³•æŸ¥æ‰¾æˆ–å­—é¢é‡è¯­æ³•æŸ¥æ‰¾</li>
<li><code>[dic removeObjectForKey]</code>æ–¹æ³•åˆ é™¤</li>
</ul>

<h3 id="toc_11">NSMutableDictionary</h3>

<ul>
<li><code>NSMutableDictionary *mDic = [NSMutableDictionary dic]</code> æ–¹æ³•åˆ›å»ºå¯¹è±¡</li>
</ul>

<h2 id="toc_12">å…¶ä»–å€¼</h2>

<p>NSArray å’Œ NSDictionary åªèƒ½å­˜å‚¨å¯¹è±¡,ä¸èƒ½ç›´æ¥å­˜å‚¨åŸºæœ¬ç±»å‹çš„æ•°æ®( int ç­‰),å¯ä»¥é€šè¿‡å°è£…æ”¾å…¥å…¶ä¸­.Objective-C ä¸æ”¯æŒè£…ç®±</p>

<h3 id="toc_13">NSNumber</h3>

<pre><code class="language-objc">NSNumber *number;
number = @&#39;123.45l&#39;;
[array addObject:number];
[dic setObject: number forKey: @&quot;vegetable&quot;];
</code></pre>

<p>å°è£…å®Œæˆå,å¯ä»¥é€šè¿‡[number floatValue] é‡æ–°è·å¾—è¿™ä¸ªå€¼</p>

<h3 id="toc_14">NSValue</h3>

<p>å¯ä»¥ç”¨ NSValue å°è£…ä»»ä½•å€¼(åŒ…æ‹¬ç»“æ„ä½“)</p>

<pre><code class="language-objc">\+ (NSValue*) valueWithByes: (const void\*) value objType:@encode( type );
</code></pre>

<pre><code class="language-objc">#import &lt;Foundation/Foundation.h&gt;

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        NSMutableArray *array= [NSMutableArray arrayWithCapacity:20];
        NSRect rect = NSMakeRect(5, 2, 10, 10);
        NSValue *value= [NSValue valueWithBytes:&amp;rect objCType:@encode(NSRect)];
        [array addObject:value];
        
        value=[array objectAtIndex:0];
        [value getValue:&amp;rect];
        NSLog(@&quot;%@&quot;,value);         //NSRect: {{5, 2}, {10, 10}}
    }
    return 0;
}
</code></pre>

<ul>
<li>ä¼ é€’çš„å‚æ•°1ä¸º <code>å°è£…æ•°å€¼çš„åœ°å€</code> </li>
<li>å‚æ•°2ä¸ºå¯¹è±¡ç±»å‹, @encode ç¼–è¯‘å™¨æŒ‡ä»¤å¯ä»¥æ¥æ”¶<code>æ•°æ®ç±»å‹çš„åç§°</code>å¹¶ç”Ÿæˆå­—ç¬¦ä¸²</li>
<li>getValue è¡¨é¢æä¾›çš„æ˜¯æŒ‡é’ˆ,æŒ‡é’ˆæ‰€æŒ‡ç©ºé—´ç”¨æ¥å­˜å‚¨<code>è¯¥æ–¹æ³•ç”Ÿæˆçš„æ•°æ®</code></li>
</ul>

<h4 id="toc_15">å¸¸ç”¨çš„ struct è½¬æˆ NSValue çš„æ–¹æ³•</h4>

<pre><code class="language-objc">\+ (NSValue* ) valueWithRect:(NSRect) rect;
</code></pre>

<h3 id="toc_16">NSNull</h3>

<p>å¯¹è±¡å‹çš„ Null</p>

<hr/>

<h2 id="toc_17">æ€»ç»“</h2>

<ol>
<li>å¯å˜çš„éƒ½æ²¡æœ‰å­—é¢é‡è¯­æ³•</li>
<li>å¯å˜çš„åˆå§‹åŒ–çš„å¤§å°å€¼åªæ˜¯å»ºè®®,ä¸é™åˆ¶å¤§å°</li>
<li>ä»£ç å—å¯ä»¥è®©å¾ªç¯æ“ä½œå¹¶å‘æ‰§è¡Œ</li>
<li>é¢‘ç¹æŸ¥è¯¢ä¸å¤§å‹çš„æ•°æ®é›†,ç”¨å­—å…¸</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(5) å†…å­˜ç®¡ç†-å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ]]></title>
    <link href="http://kayorl.com/14872504903821.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504903821.html</id>
    <content type="html"><![CDATA[
<p>è·Ÿç°å®ä¸­çš„çŒ´å­ä¸€æ ·,ç¨‹åºä¸­çš„å¯¹è±¡ä¹Ÿæœ‰ä»–ä»¬çš„ç”Ÿå‘½å‘¨æœŸ,åŒ…æ‹¬è¯ç”Ÿ( alloc || new ) æ–¹æ³•å®ç°, ç”Ÿå­˜ (æ¥æ”¶æ¶ˆæ¯å¹¶æ‰§è¡Œæ“ä½œ),æ²Ÿé€š (é€šè¿‡ç¬¦åˆä»¥åŠä¼ é€’å‚æ•°) ,ä»¥åŠå¯¿ç»ˆæ­£å¯ (è¢«é‡Šæ”¾).å½“ä¸€ç”Ÿè¿‡å»,çŒ´å­ç•™ä¸‹çš„ä¸œè¥¿,ä¾¿åˆèƒ½</p>

<blockquote>
<p>åŒ–ä½œæ˜¥æ³¥æ›´æŠ¤èŠ±.</p>
</blockquote>

<span id="more"></span><!-- more -->

<h2 id="toc_0">å¼•ç”¨è®¡æ•°</h2>

<p>Cocoa é‡‡ç”¨äº†ä¸€ç§å«åšå¼•ç”¨è®¡æ•°(reference counting)çš„æŠ€æœ¯, ä¹Ÿå«ä¿ç•™è®¡æ•°( <code>retain</code> counting ).<br/>
æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³è”çš„æ•´æ•°,å«åšå¼•ç”¨è®¡æ•°å™¨æˆ–ä¿ç•™è®¡æ•°å™¨.</p>

<ul>
<li>è®¿é—®å¯¹è±¡æ—¶, è®¡æ•°å™¨åŠ ä¸€</li>
<li>è®¿é—®ç»“æŸæ—¶, è®¡æ•°å™¨å‡ä¸€</li>
<li>è®¡æ•°å™¨ä¸º0æ—¶, OC ä¼š<code>è‡ªåŠ¨</code>å‘å¯¹è±¡å‘é€[object dealloc] æ¶ˆæ¯ , å¯ä»¥é‡å†™ dealloc æ–¹æ³•,ä½†ä¸è¦<code>ç›´æ¥è°ƒç”¨</code> dealloc æ–¹æ³•</li>
<li>ä½¿ç”¨ alloc, new, æˆ–è€… copy åˆ›å»ºå¯¹è±¡æ—¶,å¯¹è±¡çš„è®¡æ•°å™¨è¢«è®¾ç½®ä¸º1</li>
<li>å¢åŠ ä¿ç•™è®¡æ•°å™¨çš„å€¼,å¯ä»¥[object <code>retain</code>] ,åŒæ—¶ä¼šè¿”å›ä¸€ä¸ª id ç±»å‹çš„å€¼,å³å¯¹ object çš„å¼•ç”¨</li>
<li>å‡å°‘ä¿ç•™è®¡æ•°å™¨çš„å€¼,å¯ä»¥[object release] ,åŒæ—¶ä¼šè¿”å›ä¸€ä¸ª id ç±»å‹çš„å€¼,å³å¯¹ object çš„å¼•ç”¨</li>
<li>è·å¾—è®¡æ•°å™¨çš„å½“å‰å€¼,å¯ä»¥[object retainCount]</li>
</ul>

<h2 id="toc_1">å¯¹è±¡æ‰€æœ‰æƒ</h2>

<p>å¦‚æœä¸€ä¸ªå¯¹è±¡(æ–¹æ³•,ç±»çš„å¯¹è±¡)å†…æœ‰æŒ‡å‘å…¶ä»–å¯¹è±¡çš„å®ä¾‹å˜é‡,åˆ™ç§°è¯¥å¯¹è±¡æ‹¥æœ‰è¿™äº›å¯¹è±¡</p>

<ul>
<li>å¦‚æœå¤šä¸ªå¯¹è±¡è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡,é‚£ä¹ˆå¯ä»¥é€šè¿‡[object reatain]æ–¹æ³•æ¥å¢åŠ ä¿ç•™è®¡æ•°å™¨çš„å€¼</li>
</ul>

<h3 id="toc_2">è®¿é—®æ–¹æ³•ä¸­çš„ä¿ç•™å’Œé‡Šæ”¾</h3>

<p>v1: ä¿ç•™è¿‡åº¦,å¯¼è‡´å¯¹è±¡æ³„éœ²</p>

<pre><code class="language-objc">@implementation Car

...

- (void) setEngine:(Engine *) newEngine
{
  engine=[newEngine retain];
  
  //DON&#39;T DO THIS
}

...
...

//main å‡½æ•°ä¸­

//count : 1
Engine *engine1=[Engine new];

//count : 2 
[car setEngine: engine1];   

//count : 1 ,main å‡½æ•°é‡Šæ”¾äº†å¼•ç”¨,è€Œ car å¯¹ engine1 çš„å¼•ç”¨è¿˜æ²¡é‡Šæ”¾
[engine1 release];          

//count : 1,  engine2 çš„ä¿ç•™è®¡æ•°å™¨
Engine *engine2=[Engine new]        

//count : 2 , è¿™é‡Œçš„ count åŒ…æ‹¬äº†å¯¹ engine1 çš„å¼•ç”¨ ,è€Œ engine1 å·²ç»ä¸å—æ§åˆ¶äº†
[car setEngine: engine2];   

</code></pre>

<p>v2: å¯¹ v1 çš„ä¿®è¡¥,å¯¹è±¡çš„å¯¹è±¡è¢«å…¶ä»–å¯¹è±¡é‡Šæ”¾,è¿åäº†<code>å¯¹è±¡æ‰€æœ‰æƒ</code></p>

<pre><code>@implementation Car

...

- (void) setEngine:(Engine *) newEngine
{
  [engine release];
  engine=[newEngine retain];
  
  //DON&#39;T DO THIS TWO!!!!!!!!
}

...
...

//main å‡½æ•°ä¸­

//count : 1
Engine *engine=[Engine new];

Car *car1 = [Car new];
Car *car2 = [Car new];

//count : 2
[car1 setEngine: engine];   

//count : 1 , é‡Šæ”¾äº† main å‡½æ•°çš„å¼•ç”¨
[engine release];

//ERROR , car1çš„ engine è¢« car2 é‡Šæ”¾æ‰
//
[car2 setEngine: [car1 engine]];

</code></pre>

<p>v3:ä¸Šé¢ä¸¤ç§,ä¸€ç§æ˜¯ä¿ç•™è¿‡åº¦,ä¸€ç§æ˜¯é‡Šæ”¾è¿‡åº¦,ç»“åˆä¸¤ç§.è·Ÿäº¤æ¢ä¸¤ä¸ªå€¼çš„æ–¹æ³•ç›¸ä¼¼</p>

<pre><code class="language-objc">- (void) setEngine:(Engine *) newEngine
{
  [newEngine retain]
  [engine release];
  engine= newEngine;
}
</code></pre>

<hr/>

<h2 id="toc_3">è‡ªåŠ¨é‡Šæ”¾</h2>

<p>çœ‹ä¸‹é¢çš„ä»£ç ,æ˜¯è°è´Ÿè´£æ¸…ç†è¯¥å­—ç¬¦ä¸²å‘¢?</p>

<pre><code>- (NSString *) description
{
  NSString *description;
  description = [ [NSString* alloc] 
  initWithFormat:@&quot;I am @d years old&quot; , 4];
  
  return (description);
}   //description
</code></pre>

<p>è°ƒç”¨ description çš„ä»£ç å°†è¿”å›çš„å­—ç¬¦ä¸²èµ‹ç»™ä¸€ä¸ªå˜é‡,å¹¶åœ¨ä½¿ç”¨å®Œæ¯•åå°†å…¶é‡Šæ”¾<br/>
<code><br/>
NSString *desc = [object description];<br/>
NLog(@&quot;%@&quot;, desc);<br/>
[desc release];<br/>
</code></p>

<p>å¤ªéº»çƒ¦äº†,ä¸‹é¢çš„æ–¹ä¾¿äº†è®¸å¤š</p>

<h2 id="toc_4">è‡ªåŠ¨é‡Šæ”¾æ± (autorelease pool)</h2>

<p>NSObject æä¾›äº†ä¸€ä¸ªå«åš autorelease çš„æ–¹æ³• , è¿™ä¸ªæ–¹æ³•é¢„å…ˆè®¾å®šåœ¨æŸä¸ªæ—¶é—´å‘é€ release æ¶ˆæ¯,è¿”å›è‡ªå·±.</p>

<p>å½“ç»™å¯¹è±¡å‘é€ autorelease æ¶ˆæ¯æ—¶,å®é™…ä¸Š<code>å°†è¯¥å¯¹è±¡åŠ å…¥åˆ°è‡ªåŠ¨é‡Šæ”¾æ± .å½“é”€æ¯è‡ªåŠ¨é‡Šæ”¾æ± æ—¶,ä¼šè‡ªåŠ¨å‘æ‰€æœ‰å¯¹è±¡å‘é€ release æ¶ˆæ¯</code></p>

<pre><code>- (NSString *) description
{
  NSString *description;
  description = [ [NSString* alloc] 
  initWithFormat:@&quot;I am @d years old&quot; , 4];
  
  //æ­¤å¤„, description è¢«åŠ å…¥åˆ°è‡ªåŠ¨é‡Šæ”¾æ± å’¯
  return ([description autorelease] );
}   //description
</code></pre>

<p>è°ƒç”¨å°±æ˜¯ä»‹ä¹ˆç®€å•èˆ’æœ<br/>
<code><br/>
NSLog(@&quot;%@&quot;,[object description]);<br/>
</code></p>

<h3 id="toc_5">è‡ªåŠ¨é‡Šæ”¾æ± çš„é”€æ¯æ—¶é—´</h3>

<p>åˆ›å»ºè‡ªåŠ¨é‡Šæ”¾æ± çš„æ–¹æ³•</p>

<ul>
<li>@autoreleasepoolå…³é”®å­—,é€‚ç”¨äºå†…å­˜å¯†é›†å‹</li>
<li>NSAutoreleasePool å¯¹è±¡ , ä¸æ¨è , æ¯”æ¥¼ä¸Šæ…¢</li>
</ul>

<pre><code class="language-objc">NSAutoreleasePool *pool
pool = [NSAutoreleasePool new];

...

[pool release]; 
</code></pre>

<p>è‡ªåŠ¨é‡Šæ”¾æ± è¢«é”€æ¯çš„æ—¶å€™,å…¶ <code>dealloc</code> æ–¹æ³•è¢«è°ƒç”¨</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OC(4) self éšè—å¾ˆæ·±çš„å‚æ•°]]></title>
    <link href="http://kayorl.com/14872504903717.html"/>
    <updated>2017-02-16T21:08:10+08:00</updated>
    <id>http://kayorl.com/14872504903717.html</id>
    <content type="html"><![CDATA[
<p>åˆ›å»ºä¸€ä¸ªæ–°ç±»æ—¶,ä¼šä»å®ƒçš„è¶…ç±»ç»§æ‰¿å®ä¾‹å˜é‡,ç„¶åæ ¹æ®è‡ªå·±æƒ…å†µæ·»åŠ å®ä¾‹å˜é‡.ä¸‹é¢æ˜¯ RoundedRectangle å¯¹è±¡çš„å†…å­˜å¸ƒå±€</p>

<span id="more"></span><!-- more -->

<table>
<thead>
<tr>
<th style="text-align: center">æŒ‡é’ˆ</th>
<th style="text-align: center">å˜é‡</th>
<th style="text-align: center">ç±»</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: center">self-&gt;</td>
<td style="text-align: center">isa</td>
<td style="text-align: center">NSObject</td>
</tr>
<tr>
<td style="text-align: center">fillColor</td>
<td style="text-align: center">Shape</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: center">bounds</td>
<td style="text-align: center">Shape</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: center">radius</td>
<td style="text-align: center">RoundedRectangle</td>
<td style="text-align: center"></td>
</tr>
</tbody>
</table>

<pre><code>@implementation Circle

- (void) setFillColor: (ShapeColor) c
{
    fillColor = c ;
}

@end

</code></pre>

<ul>
<li>æ¯ä¸ªå®ä¾‹éƒ½æœ‰ç±»ä¼¼ä¸Šé¢çš„å†…å­˜å¸ƒå±€,</li>
<li>æ¯ä¸ªæ–¹æ³•è°ƒç”¨éƒ½è·å¾—äº†å« self çš„éšè—å‚æ•°,å®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘æ¥æ”¶æ¶ˆæ¯çš„å¯¹è±¡çš„æŒ‡é’ˆ</li>
<li><code>self</code> å‡½æ•°æŒ‡å‘è¯¥å†…å­˜å¸ƒå±€ä¸­çš„é¦–åœ°å€,å³ <code>isa</code></li>
<li>å¦‚ä»£ç æ‰€ç¤º, fillColor = c æ—¶,å®é™…æ˜¯ self -&gt; fillColor = c </li>
</ul>

<blockquote>
<p>Objective-C objects are basically C structs. Each one contains a field called isa, which <code>is a pointer to the class that the object is an instance of</code>(that&#39;s how the object and Objective-C runtime knows what kind of object it is). FROM <a href="http://stackoverflow.com/questions/3405224/what-does-isa-mean-in-objective-c">stackoverflow</a></p>
</blockquote>

]]></content>
  </entry>
  
</feed>
